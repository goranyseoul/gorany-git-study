# 친구 초대 & 배틀패스 PRD

> **원본**: [Confluence](https://bugcity.atlassian.net/wiki/spaces/BUGCITY/pages/421462017)  
> **버전**: 1.2

---

## 1. 개요

### 목적

* 친구 초대를 통한 바이럴 성장
* 배틀패스로 입금 및 참여 동기 부여
* 전화번호 인증으로 어뷰징 방지
* 친구 Nudge로 리텐션 강화

### 핵심 원칙

* **배틀패스 중심** — 레벨/보상 진행 상황을 명확히 시각화
* **초대 유도** — 친구 초대가 XP 획득의 핵심 수단
* **인증 필수** — 전화번호 인증 없이 배틀패스 보상 불가
* **소셜 연결** — 친구 Nudge로 이탈 유저 재유입

---

## 2. 화면 구성

```
┌─────────────────────────────────────┐
│  ←  친구 초대                        │
├─────────────────────────────────────┤
│  [배틀패스 카드]                      │
│  ┌─────────────────────────────┐    │
│  │ ⛏️ Lv.5        9mg / 34mg   │    │
│  │ ━━━━━━━━━━━━━ 350/500 XP   │    │
│  │ ⚡ 채굴량 5배 부스트 적용 중   │    │
│  ├─────────────────────────────┤    │
│  │ ①━②━③━④━⑤━⑥━⑦━⑧━⑨━⑩   │    │
│  │ (수평 스크롤 레벨 로드맵)      │    │
│  └─────────────────────────────┘    │
├─────────────────────────────────────┤
│  [XP 획득 방법]                      │
│  👥 친구 초대      +50 XP / 1명      │
│  💰 달러 입금      +5 XP / $1        │
│  👆 친구 콕 찌르기  +1 XP / 1회       │
│     (친구가 금캐기 시작하면 +3 XP)    │
├─────────────────────────────────────┤
│  [초대 링크 공유]                     │
│    🔗 초대 링크 복사                  │
│    📤 카카오톡/문자 공유              │
├─────────────────────────────────────┤
│  [내 친구들]              👥 3명     │
│  김** (내가 초대)           [콕 찌르기] │
│  이** (나를 초대)            채굴 중   │
│  박** (내가 초대)           [콕 찌르기] │
├─────────────────────────────────────┤
│  🏠 홈    👥 친구 초대    ⚙️ 설정    │
└─────────────────────────────────────┘
```

---

## 3. XP 획득 방법

| 방법 | XP | 클릭 시 |
| --- | --- | --- |
| 친구 초대 | +50 XP / 1명 | 초대 링크 섹션으로 스크롤 |
| 달러 입금 | +5 XP / $1 | Receive 화면 이동 |
| 친구 Nudge 발송 | +1 XP / 1회 | 친구 목록으로 스크롤 |
| Nudge 성공 | +3 XP | 자동 지급 |

---

## 4. 친구 목록 섹션

### 4.1 친구 카드

| 항목 | 표시 |
| --- | --- |
| 닉네임 | 마스킹 (김**) |
| 관계 | "(내가 초대)" / "(나를 초대)" |
| 상태 | "채굴 중" / "수확 가능" / "대기 중" |
| Nudge 버튼 | 가능 시 활성화 |

### 4.2 Nudge 버튼 상태

| 친구 상태 | 버튼 |
| --- | --- |
| harvestable | [콕 찌르기] 활성화 |
| idle | [콕 찌르기] 활성화 |
| mining | "채굴 중" 텍스트 |
| 24시간 내 Nudge 발송 | "발송완료 ✓" 비활성화 |

---

## 5. 초대 링크

### 5.1 링크 복사

| 항목 | 스펙 |
| --- | --- |
| 형식 | bit.ly 단축 URL |
| 내용 | 앱스토어 + 레퍼럴 코드 |
| 복사 버튼 | 클릭 시 클립보드 복사 + 토스트 |

### 5.2 공유 버튼

| 채널 | 동작 |
| --- | --- |
| 카카오톡 | 카카오 공유 API |
| 문자 | 기본 문자 앱 |
| 기타 | 시스템 공유 시트 |

---

## 6. 어뷰징 방지

### 6.1 전화번호 인증

| 정책 | 내용 |
| --- | --- |
| 1인 1번호 | 동일 전화번호로 중복 인증 불가 |
| 번호 변경 제한 | 인증 후 번호 변경 불가 (CS 문의 필요) |
| 가상번호 차단 | 070, 050 등 가상번호 인증 불가 |

### 6.2 추가 탐지

| 유형 | 탐지 방법 |
| --- | --- |
| 다계정 생성 | 동일 기기 ID 체크 |
| 자기 초대 | 동일 IP + 기기 검증 |
| 봇 가입 | 행동 패턴 분석 |

---

## 7. API

| API | 메서드 | 설명 |
| --- | --- | --- |
| /referral/code | GET | 내 초대 코드 |
| /referral/apply | POST | 초대 코드 적용 |
| /referral/stats | GET | 초대 현황 |
| /friends | GET | 친구 목록 + 상태 |
| /friends/{id}/nudge | POST | Nudge 발송 |

---

## 8. QA 체크리스트

### 8.1 배틀패스
- [ ] 현재 레벨/XP 정확히 표시
- [ ] 레벨 로드맵 수평 스크롤
- [ ] 레벨 노드 클릭 시 보상 팝업

### 8.2 초대 링크
- [ ] 링크 복사 동작
- [ ] 카카오톡 공유 동작
- [ ] 문자 공유 동작

### 8.3 친구 목록
- [ ] 친구 목록 로드
- [ ] 닉네임 마스킹
- [ ] Nudge 버튼 동작
- [ ] 24시간 쿨다운 적용
