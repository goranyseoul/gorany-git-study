<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Lair Cash - í”„ë¡œí† íƒ€ì… v2</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap');

    * {
      font-family: 'Noto Sans KR', sans-serif;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      background: linear-gradient(135deg, #1a1a2e 0%, #0f0f23 100%);
      margin: 0;
      padding: 0;
    }

    .phone-frame {
      width: 375px;
      height: 812px;
      background: #111;
      border-radius: 40px;
      overflow: hidden;
      position: relative;
      box-shadow: 0 0 0 12px #222, 0 0 60px rgba(0,0,0,0.5);
    }

    .screen {
      width: 100%;
      height: 100%;
      overflow-y: auto;
      overflow-x: hidden;
    }

    .screen::-webkit-scrollbar {
      display: none;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes popIn {
      0% { transform: scale(0.5); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }

    @keyframes pulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.7); }
      50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
    }

    @keyframes goldFall {
      0% { transform: translateY(-50px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }

    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }

    @keyframes toastIn {
      from { transform: translateX(-50%) translateY(20px); opacity: 0; }
      to { transform: translateX(-50%) translateY(0); opacity: 1; }
    }

    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }

    .animate-fadeIn { animation: fadeIn 0.3s ease-out; }
    .animate-popIn { animation: popIn 0.3s ease-out; }
    .animate-pulse-gold { animation: pulse 1.5s infinite; }
    .animate-slideUp { animation: slideUp 0.3s ease-out; }
    .animate-toastIn { animation: toastIn 0.3s ease-out; }

    .gold-particle {
      position: absolute;
      font-size: 24px;
      animation: goldFall 2s ease-in forwards;
      z-index: 9999;
      pointer-events: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
      color: white;
      font-weight: 600;
      padding: 14px 24px;
      border-radius: 12px;
      width: 100%;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary:hover:not(:disabled) {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
    }

    .btn-primary:active:not(:disabled) {
      transform: translateY(0);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: transparent;
      color: #9CA3AF;
      font-weight: 500;
      padding: 12px 24px;
      border: none;
      cursor: pointer;
    }

    .btn-small {
      background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
      color: white;
      font-weight: 500;
      padding: 8px 16px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-size: 14px;
      white-space: nowrap;
    }

    .btn-outline {
      background: transparent;
      color: #F59E0B;
      border: 1px solid #F59E0B;
      padding: 12px 24px;
      border-radius: 12px;
      font-weight: 500;
      cursor: pointer;
    }

    .card {
      background: #1F1F1F;
      border-radius: 16px;
      padding: 16px;
      border: 1px solid #333;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }

    .badge-green { background: rgba(34, 197, 94, 0.2); color: #22C55E; }
    .badge-blue { background: rgba(59, 130, 246, 0.2); color: #3B82F6; }
    .badge-gold { background: rgba(245, 158, 11, 0.2); color: #F59E0B; }
    .badge-gray { background: rgba(156, 163, 175, 0.2); color: #9CA3AF; }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px 16px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .nav-item.active { color: #F59E0B; }
    .nav-item:not(.active) { color: #6B7280; }

    .progress-bar {
      height: 8px;
      background: #333;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #F59E0B, #FBBF24);
      border-radius: 4px;
      transition: width 0.5s ease-out;
    }

    .level-dot {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 600;
      transition: all 0.2s;
      flex-shrink: 0;
    }

    .level-dot.locked { background: #333; color: #666; border: 2px solid #444; }
    .level-dot.unlockable { background: #1F1F1F; color: #F59E0B; border: 2px solid #F59E0B; animation: pulse 1.5s infinite; cursor: pointer; }
    .level-dot.claimed { background: #F59E0B; color: #000; border: 2px solid #F59E0B; }

    .toast {
      position: absolute;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%);
      background: #22C55E;
      color: white;
      padding: 12px 20px;
      border-radius: 12px;
      font-weight: 500;
      z-index: 1000;
      animation: toastIn 0.3s ease-out;
      white-space: nowrap;
    }

    .modal-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .modal-content {
      background: #1F1F1F;
      border-radius: 20px;
      padding: 24px;
      width: 280px;
      text-align: center;
      animation: popIn 0.3s ease-out;
    }

    .quiz-option {
      width: 100%;
      padding: 16px;
      border-radius: 12px;
      text-align: left;
      transition: all 0.2s;
      border: 2px solid transparent;
      background: #2A2A2A;
      color: white;
      cursor: pointer;
    }

    .quiz-option:hover {
      border-color: #4B5563;
    }

    .quiz-option.correct {
      background: rgba(34, 197, 94, 0.2);
      border-color: #22C55E;
    }

    .quiz-option.wrong {
      background: rgba(239, 68, 68, 0.2);
      border-color: #EF4444;
    }

    .friend-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-top: 1px solid #333;
    }

    .friend-row:first-child {
      border-top: none;
    }

    .toggle-switch {
      display: inline-flex;
      align-items: center;
      background: #4B4B4B;
      border-radius: 20px;
      padding: 3px;
      width: 48px;
      height: 28px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .toggle-switch.on {
      background: #F59E0B;
    }

    .toggle-switch-knob {
      width: 22px;
      height: 22px;
      background: white;
      border-radius: 50%;
      transition: transform 0.3s;
    }

    .toggle-switch.on .toggle-switch-knob {
      transform: translateX(20px);
    }

    .otp-input {
      width: 32px;
      height: 40px;
      border: 2px solid #444;
      border-radius: 8px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
      color: white;
      background: #1F1F1F;
      margin: 0 6px;
    }

    .otp-input:focus {
      outline: none;
      border-color: #F59E0B;
      background: #2A2A2A;
    }

    .otp-input.filled {
      border-color: #F59E0B;
      background: #2A2A2A;
    }

    .banner-top {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
      color: white;
      padding: 16px;
      text-align: center;
      border-radius: 12px;
      margin: 12px;
      z-index: 999;
      animation: fadeIn 0.3s ease-out;
    }

    .success-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      animation: fadeIn 0.3s ease-out;
    }

    .locked-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      gap: 20px;
      text-align: center;
      color: white;
    }

    .countdown-timer {
      font-size: 14px;
      color: #F59E0B;
      font-weight: 600;
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useCallback, useRef } = React;

    // ===== ìƒìˆ˜ ì •ì˜ (PRD ê¸°ë°˜) =====
    const QUIZ_DATA = [
      {
        card: "ì„¸ê³„ ê²½ì œê°€ ë¶ˆì•ˆí•  ë•Œ ë‚´ ëˆì„ ì§€í‚¤ëŠ” ê°€ì¥ í™•ì‹¤í•œ ë°©ë²•ì€ ë¯¸êµ­ ë‹¬ëŸ¬(USD)ì™€ ê¸ˆ(Gold) ê°™ì€ ì•ˆì „ ìì‚°ì„ ëª¨ìœ¼ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë“¤ì€ ë‹¹ì‹ ì˜ êµ¬ë§¤ë ¥ì„ ë“ ë“ í•˜ê²Œ ë°©ì–´í•´ ì¤ë‹ˆë‹¤.",
        question: "ê²½ì œê°€ í”ë“¤ë¦´ ë•Œ ë‚´ ìì‚°ì„ ì§€ì¼œì£¼ëŠ” 'ê°€ì¥ ì•ˆì „í•œ ë°©íŒ¨' ë‘ ê°€ì§€ëŠ”?",
        options: ["í•œêµ­ ì›í™”ì™€ ì—”í™”", "ë¯¸êµ­ ë‹¬ëŸ¬ì™€ ê¸ˆ", "ë¹„íŠ¸ì½”ì¸ê³¼ ì´ë”ë¦¬ì›€"],
        correct: 1,
        icon: "ğŸ›¡ï¸"
      },
      {
        card: "USDCëŠ” ê°€ì¹˜ê°€ í•­ìƒ 1ë‹¬ëŸ¬($1)ì— ê³ ì •ëœ ë””ì§€í„¸ í™”íì…ë‹ˆë‹¤. ë³€ë™ì„± ê±±ì • ì—†ì´ ì „ ì„¸ê³„ ì–´ë””ì„œë‚˜ ë‹¬ëŸ¬ì™€ ë˜‘ê°™ì´ í†µìš©ë©ë‹ˆë‹¤.",
        question: "1 USDCì˜ ê°€ì¹˜ëŠ” í•­ìƒ ì–¼ë§ˆì™€ ê°™ì„ê¹Œìš”?",
        options: ["ì‹œì„¸ì— ë”°ë¼ ë³€í•¨", "ì–¸ì œë‚˜ 1ë‹¬ëŸ¬($1)", "1,000ì› ê³ ì •"],
        correct: 1,
        icon: "ğŸ’µ"
      },
      {
        card: "ì´ì œ ë¬´ê±°ìš´ ê¸ˆê´´ë¥¼ ì§‘ì— ë³´ê´€í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ê¸ˆì„ ë””ì§€í„¸ í† í°ìœ¼ë¡œ ë§Œë“¤ë©´ ìŠ¤ë§ˆíŠ¸í°ì—ì„œ mg(ë°€ë¦¬ê·¸ë¨) ë‹¨ìœ„ë¡œ ê°€ë³ê²Œ ìª¼ê°œì„œ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        question: "ë””ì§€í„¸ ê¸ˆ(í† í°)ì˜ ê°€ì¥ í° ì¥ì ì€ ë¬´ì—‡ì¸ê°€ìš”?",
        options: ["ì¥ì‹ìš©ìœ¼ë¡œ ì˜ˆì˜ë‹¤", "ì†Œì•¡ìœ¼ë¡œë„ ì‰½ê²Œ ì†Œìœ í•  ìˆ˜ ìˆë‹¤", "ê¸ˆë°© ë…¹ì•„ë²„ë¦°ë‹¤"],
        correct: 1,
        icon: "ğŸ¥‡"
      },
      {
        card: "ê¸°ì¡´ ê¸ˆìœµ ì‹œìŠ¤í…œì€ ì£¼ë§ì´ë‚˜ ë°¤ì— ë©ˆì¶¥ë‹ˆë‹¤. í•˜ì§€ë§Œ ë””ì§€í„¸ ìì‚°ì€ 365ì¼ 24ì‹œê°„ ì–¸ì œë“  ë‚´ê°€ ì›í•  ë•Œ ì‚¬ê³ íŒ” ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        question: "ì´ ì„œë¹„ìŠ¤ì—ì„œ ìì‚°ì„ ê±°ë˜í•  ìˆ˜ ìˆëŠ” ì‹œê°„ì€?",
        options: ["ì€í–‰ ì˜ì—…ì‹œê°„ë§Œ", "í‰ì¼ ë‚® ì‹œê°„ë§Œ", "24ì‹œê°„ ì–¸ì œë‚˜"],
        correct: 2,
        icon: "ğŸ•"
      },
      {
        card: "ì‹¤ë¬¼ ê¸ˆì€ ì‚´ ë•Œ ë¹„ì‹¸ê³  ë³´ê´€ë£Œë„ ë“­ë‹ˆë‹¤. ë””ì§€í„¸ ê¸ˆì€ ë³´ê´€ë£Œë‚˜ ë³´ì¦ì„œ ë¶„ì‹¤ ê±±ì •ì´ ì—†ì–´ì„œ íˆ¬ì ë¹„ìš©ì„ íšê¸°ì ìœ¼ë¡œ ë‚®ì¶° ì¤ë‹ˆë‹¤.",
        question: "ë””ì§€í„¸ ê¸ˆ íˆ¬ìê°€ ë” ìœ ë¦¬í•œ ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?",
        options: ["ë³´ê´€ë£Œ ë“± ë¶ˆí•„ìš”í•œ ë¹„ìš©ì´ ì—†ë‹¤", "ì¢…ì´ ë³´ì¦ì„œë¥¼ ì£¼ê¸° ë•Œë¬¸ì´ë‹¤", "ì„¸ê¸ˆì„ ë” ë§ì´ ë‚´ì„œ"],
        correct: 0,
        icon: "ğŸ’°"
      },
      {
        card: "ë‹¹ì‹ ì˜ ìŠ¤ë§ˆíŠ¸í°ì— ìˆëŠ” ë””ì§€í„¸ ê¸ˆê³¼ ë‹¬ëŸ¬ëŠ” ë‹¨ìˆœí•œ ìˆ«ìê°€ ì•„ë‹™ë‹ˆë‹¤. USDCëŠ” ë°œí–‰ëœ ë§Œí¼ì˜ ì‹¤ì œ í˜„ê¸ˆì´ ë¯¸êµ­ ì€í–‰ ê¸ˆê³ ì— ë³´ê´€ë˜ì–´ ìˆê³ , ë””ì§€í„¸ ê¸ˆ ì—­ì‹œ ì‹¤ì œ ê¸ˆê³  ì† ê¸ˆê´´ì™€ 1:1ë¡œ ì—°ê²°ë˜ì–´ ìˆìŠµë‹ˆë‹¤.",
        question: "ë””ì§€í„¸ ê¸ˆê³¼ USDCê°€ ì‹¤ì œ ìì‚°ë§Œí¼ ì•ˆì „í•˜ë‹¤ê³  ì‹ ë¢°ë°›ëŠ” ê²°ì •ì ì¸ ì´ìœ ëŠ”?",
        options: ["ì¸í„°ë„·ì—ì„œ ê°€ì¥ ì¸ê¸° ìˆëŠ” ìì‚°ì´ë¼ì„œ", "ë°œí–‰ëŸ‰ë§Œí¼ ì‹¤ì œ ê¸ˆê³¼ ë‹¬ëŸ¬ë¥¼ ì€í–‰ê³¼ ê¸ˆê³ ì— 1:1ë¡œ ë³´ê´€í•˜ê³  ìˆì–´ì„œ", "ê°€ê²©ì´ ë§¤ì¼ë§¤ì¼ ë¹ ë¥´ê²Œ ë³€í•˜ê¸° ë•Œë¬¸ì—"],
        correct: 1,
        icon: "ğŸ”’"
      },
      {
        card: "ê¸ˆì€ë°©ì— ê°€ì„œ ê¸ˆì„ íŒŒëŠ” ê±´ ë²ˆê±°ë¡­ìŠµë‹ˆë‹¤. ì´ê³³ì—ì„œëŠ” í´ë¦­ í•œ ë²ˆìœ¼ë¡œ ê¸ˆì„ ë‹¬ëŸ¬(USDC)ë¡œ ë°”ê¾¸ê³ , í•„ìš”í•  ë•Œ ì¦‰ì‹œ í˜„ê¸ˆí™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
        question: "ë””ì§€í„¸ ê¸ˆì„ í˜„ê¸ˆí™”í•˜ëŠ” ê°€ì¥ ë¹ ë¥¸ ë°©ë²•ì€?",
        options: ["íƒë°°ë¡œ ê¸ˆì„ ë³´ë‚¸ë‹¤", "ì•±ì—ì„œ ì¦‰ì‹œ ë‹¬ëŸ¬ë¡œ ë³€í™˜í•œë‹¤", "ì¹œêµ¬ì—ê²Œ ë¹Œë ¤ì¤€ë‹¤"],
        correct: 1,
        icon: "âš¡"
      },
      {
        card: "ë””ì§€í„¸ ìì‚°ì€ ë¯¸ êµ­ì±„ ìˆ˜ìµë¥ ê³¼ ì—°ë™ë˜ì–´ ì•ˆì „í•˜ê²Œ ì´ìê°€ ë¶™ëŠ” ìƒí’ˆìœ¼ë¡œ ì¬íˆ¬ìë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì„œë ì† í˜„ê¸ˆì€ ê°€ë§Œíˆ ìˆìœ¼ë©´ ë¬¼ê°€ì— ë°€ë¦¬ì§€ë§Œ, ì—¬ê¸°ì„  ê¾¸ì¤€íˆ ìˆ˜ìµì´ ìŒ“ì…ë‹ˆë‹¤.",
        question: "ì„œë ì† í˜„ê¸ˆê³¼ ë””ì§€í„¸ ì•ˆì „ ìì‚°ì˜ ì°¨ì´ì ì€?",
        options: ["ì°¨ì´ê°€ ì—†ë‹¤", "ë””ì§€í„¸ ìì‚°ì€ ìˆ˜ìµì´ ìŒ“ì¼ ìˆ˜ ìˆë‹¤", "í˜„ê¸ˆì´ ë” ë¹ ë¥´ë‹¤"],
        correct: 1,
        icon: "ğŸ“ˆ"
      },
      {
        card: "ë¸”ë¡ì²´ì¸ ìœ„ì˜ ê¸°ë¡ì€ ëˆ„êµ¬ë„ ì¡°ì‘í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë‹¹ì‹ ì˜ ì†Œìœ ê¶Œì€ ì „ ì„¸ê³„ê°€ ê³µìœ í•˜ëŠ” ë””ì§€í„¸ ì¥ë¶€ì— ì˜êµ¬íˆ ê¸°ë¡ë©ë‹ˆë‹¤.",
        question: "ë‚´ ì†Œìœ ê¶Œì´ ì•ˆì „í•˜ê²Œ ê¸°ë¡ë˜ëŠ” ë°©ì‹ì€?",
        options: ["ë©”ëª¨ì¥ì— ì ì–´ë‘”ë‹¤", "ì¡°ì‘ ë¶ˆê°€ëŠ¥í•œ ë””ì§€í„¸ ì¥ë¶€ì— ê¸°ë¡ëœë‹¤", "ì•„ë¬´ë„ ëª¨ë¥´ê²Œ ìˆ¨ê¸´ë‹¤"],
        correct: 1,
        icon: "ğŸ“‹"
      },
      {
        card: "ì´ì œ ë‹¹ì‹ ì€ ë‹¬ëŸ¬ì™€ ê¸ˆì„ ìŠ¤ë§ˆíŠ¸í•˜ê²Œ ì†Œìœ í•˜ëŠ” ë²•ì„ ë§ˆìŠ¤í„°í–ˆìŠµë‹ˆë‹¤. ì§€ê¸ˆ ë°”ë¡œ ê¸ˆì„ ìŒ“ê¸° ì‹œì‘í•˜ì„¸ìš”. ì¶•í•˜í•©ë‹ˆë‹¤!",
        question: "ë§ˆìŠ¤í„° ì½”ìŠ¤ë¥¼ ë§ˆì¹œ ì†Œê°ìœ¼ë¡œ ê°€ì¥ ì ì ˆí•œ ê²ƒì€?",
        options: ["ì—¬ì „íˆ ì–´ë µë‹¤", "ì´ì œ ì•ˆì „í•˜ê²Œ ìì‚°ì„ ë¶ˆë¦´ ì¤€ë¹„ê°€ ëë‹¤!", "ë‚˜ì¤‘ì— ë‹¤ì‹œ í•˜ê² ë‹¤"],
        correct: 1,
        icon: "ğŸ†"
      }
    ];

    // ë°°í‹€íŒ¨ìŠ¤ ë ˆë²¨ (PRD ê¸°ë°˜)
    const BATTLEPASS_LEVELS = [
      { level: 1, xpRequired: 50, reward: 1 },
      { level: 2, xpRequired: 50, reward: 1 },
      { level: 3, xpRequired: 100, reward: 2 },
      { level: 4, xpRequired: 100, reward: 2 },
      { level: 5, xpRequired: 200, reward: 3 },
      { level: 6, xpRequired: 250, reward: 3 },
      { level: 7, xpRequired: 250, reward: 4 },
      { level: 8, xpRequired: 500, reward: 5 },
      { level: 9, xpRequired: 500, reward: 5 },
      { level: 10, xpRequired: 1000, reward: 8 },
    ];

    // ğŸ® ë°ëª¨ìš©: ì¹œêµ¬ ëª©ë¡ ë¹„ì›€ (ì‹ ê·œ ìœ ì € ìƒíƒœ)
    // ì´ˆëŒ€ ë§í¬ ê³µìœ  ë²„íŠ¼ìœ¼ë¡œ ì¹œêµ¬ ì¶”ê°€ ì‹œë®¬ë ˆì´ì…˜ ê°€ëŠ¥
    const INITIAL_FRIENDS = [];

    // ì¿¨íƒ€ì„ ë¡œì§ (PRD ê¸°ë°˜: 10ì´ˆâ†’30ì´ˆâ†’1ë¶„â†’2ë¶„â†’5ë¶„â†’10ë¶„â†’20ë¶„â†’40ë¶„â†’60ë¶„â†’ì´í›„ +5ë¶„ì”©)
    const COOLDOWN_SEQUENCE = [10, 30, 60, 120, 180, 300, 420, 600, 900, 1200];
    const MAX_COOLDOWN = 1200; // 20ë¶„
    const COOLDOWN_INCREMENT = 300; // 20ë¶„ ì´í›„ +5ë¶„ì”©

    // ===== ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ =====
    const formatTime = (seconds) => {
      const mins = Math.floor(seconds / 60);
      const secs = seconds % 60;
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    };

    const getCumulativeXP = (level) => {
      return BATTLEPASS_LEVELS.slice(0, level).reduce((sum, l) => sum + l.xpRequired, 0);
    };

    const getCurrentLevel = (xp) => {
      let cumulative = 0;
      for (let i = 0; i < BATTLEPASS_LEVELS.length; i++) {
        cumulative += BATTLEPASS_LEVELS[i].xpRequired;
        if (xp < cumulative) return i + 1;
      }
      return 10;
    };

    // ===== ê³µí†µ ì»´í¬ë„ŒíŠ¸ =====

    // ê¸ˆ íŒŒí‹°í´ ì• ë‹ˆë©”ì´ì…˜
    const GoldParticles = ({ containerRef }) => {
      useEffect(() => {
        if (!containerRef.current) return;
        const particles = ['ğŸª™', 'âœ¨', 'ğŸ’°', 'â­'];

        for (let i = 0; i < 30; i++) {
          setTimeout(() => {
            const particle = document.createElement('div');
            particle.className = 'gold-particle';
            particle.textContent = particles[Math.floor(Math.random() * particles.length)];
            particle.style.left = Math.random() * 100 + '%';
            particle.style.animationDuration = (1.5 + Math.random()) + 's';
            containerRef.current.appendChild(particle);
            setTimeout(() => particle.remove(), 2500);
          }, i * 50);
        }
      }, []);

      return null;
    };

    // Toast ì»´í¬ë„ŒíŠ¸
    const Toast = ({ message, onClose }) => {
      useEffect(() => {
        const timer = setTimeout(onClose, 2000);
        return () => clearTimeout(timer);
      }, [onClose]);

      return <div className="toast">{message}</div>;
    };

    // Modal ì»´í¬ë„ŒíŠ¸
    const Modal = ({ children, onClose }) => (
      <div className="modal-overlay" onClick={onClose}>
        <div className="modal-content" onClick={e => e.stopPropagation()}>
          {children}
        </div>
      </div>
    );

    // í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜
    const BottomNav = ({ active, onChange }) => (
      <div className="absolute bottom-0 left-0 right-0 bg-[#1A1A1A] border-t border-[#333] px-4 py-2 flex justify-around">
        <div className={`nav-item ${active === 'home' ? 'active' : ''}`} onClick={() => onChange('home')}>
          <span className="text-xl">ğŸ </span>
          <span className="text-xs">í™ˆ</span>
        </div>
        <div className={`nav-item ${active === 'friends' ? 'active' : ''}`} onClick={() => onChange('friends')}>
          <span className="text-xl">ğŸ‘¥</span>
          <span className="text-xs">ì¹œêµ¬ ì´ˆëŒ€</span>
        </div>
        <div className={`nav-item ${active === 'settings' ? 'active' : ''}`} onClick={() => onChange('settings')}>
          <span className="text-xl">âš™ï¸</span>
          <span className="text-xs">ì„¤ì •</span>
        </div>
      </div>
    );

    // ===== ì˜¨ë³´ë”© í™”ë©´ë“¤ =====

    // ì„œë¹„ìŠ¤ ì†Œê°œ í™”ë©´
    const IntroScreen = ({ onNext }) => (
      <div className="screen bg-[#111] flex flex-col items-center justify-center px-6 text-white animate-fadeIn">
        <div className="text-6xl mb-8">ğŸ’µ â†’ ğŸª™</div>
        <h1 className="text-2xl font-bold mb-2">ë‹¬ëŸ¬ë¡œ ê¸ˆìºê¸°</h1>
        <h2 className="text-xl text-amber-400 mb-6">í€´ì¦ˆ í’€ê³  ê¸ˆ ë°›ê¸°</h2>
        <p className="text-gray-400 text-center mb-4">
          5ë¶„ ë§Œì— ë‹¬ëŸ¬ íˆ¬ì ì›ë¦¬ë¥¼<br/>ë°°ìš°ê³ , ê¸ˆ ëª¨ìœ¼ê¸°ë¥¼ ì‹œì‘í•˜ì„¸ìš”.
        </p>
        <div className="bg-amber-500/20 text-amber-400 px-4 py-3 rounded-xl mb-8 text-center">
          ğŸ ì§€ê¸ˆ ë¬¸ì œë¥¼ í’€ë©´<br/>ê¸ˆ 10mgì„ ë“œë¦½ë‹ˆë‹¤
        </div>
        <button className="btn-primary" onClick={onNext}>
          ê¸ˆ ìºëŸ¬ ê°€ê¸°
        </button>
      </div>
    );

    // í€´ì¦ˆ í™”ë©´
    const QuizScreen = ({ onComplete, onSkip, containerRef }) => {
      const [step, setStep] = useState(0);
      const [selectedAnswer, setSelectedAnswer] = useState(null);
      const [showResult, setShowResult] = useState(false);
      const [showSkipModal, setShowSkipModal] = useState(false);
      const [showGoldParticles, setShowGoldParticles] = useState(false);
      const quiz = QUIZ_DATA[step % QUIZ_DATA.length];
      const totalSteps = 10;

      const handleAnswer = (index) => {
        if (showResult) return;
        setSelectedAnswer(index);

        if (index === quiz.correct) {
          setShowResult(true);
          setShowGoldParticles(true);
          setTimeout(() => {
            setShowResult(false);
            setShowGoldParticles(false);
            setSelectedAnswer(null);
            if (step < totalSteps - 1) {
              setStep(step + 1);
            } else {
              onComplete();
            }
          }, 1500);
        }
      };

      return (
        <div className="screen bg-[#111] text-white">
          {showGoldParticles && <GoldParticles containerRef={containerRef} />}

          <div className="p-4 flex justify-between items-center">
            <button className="text-gray-400 text-xl">â†</button>
            <span className="text-gray-400">{step + 1}/{totalSteps}</span>
            <button className="text-gray-400 text-sm font-normal hover:text-gray-300 transition-colors" onClick={() => setShowSkipModal(true)}>ê±´ë„ˆë›°ê¸°</button>
          </div>

          <div className="px-6 pt-4 animate-fadeIn" key={step}>
            <div className="text-5xl text-center mb-6">{quiz.icon}</div>

            <div className="card mb-6">
              <p className="text-gray-300 text-sm">{quiz.card}</p>
            </div>

            <p className="text-lg font-medium mb-4">Q. {quiz.question}</p>

            <div className="space-y-3">
              {quiz.options.map((option, index) => (
                <button
                  key={index}
                  className={`quiz-option ${
                    selectedAnswer === index
                      ? index === quiz.correct ? 'correct' : 'wrong'
                      : ''
                  }`}
                  onClick={() => handleAnswer(index)}
                  disabled={showResult}
                >
                  {option}
                </button>
              ))}
            </div>
          </div>

          {showResult && (
            <Modal onClose={() => {}}>
              <div className="text-5xl mb-4">ğŸ‰</div>
              <h3 className="text-xl font-bold text-white mb-2">ì •ë‹µ!</h3>
              <p className="text-amber-400 text-lg">ğŸª™ +1mg íšë“!</p>
            </Modal>
          )}

          {showSkipModal && (
            <Modal onClose={() => setShowSkipModal(false)}>
              <h3 className="text-lg font-bold text-white mb-3">í€´ì¦ˆë¥¼ ê±´ë„ˆë›¸ê¹Œìš”?</h3>
              <p className="text-gray-400 text-sm mb-6">
                ì§€ê¸ˆ ê±´ë„ˆë›°ë©´<br/>ê¸ˆ 10mg ë³´ìƒì„ ë°›ì„ ìˆ˜ ì—†ì–´ìš”.
              </p>
              <button className="btn-primary mb-3" onClick={() => setShowSkipModal(false)}>
                ê³„ì† í’€ê¸°
              </button>
              <button className="btn-secondary w-full" onClick={onSkip}>
                ê±´ë„ˆë›°ê¸°
              </button>
            </Modal>
          )}
        </div>
      );
    };

    // ì™„ì£¼ ì¶•í•˜ í™”ë©´
    const CompleteScreen = ({ onNext, containerRef }) => {
      const [showParticles, setShowParticles] = useState(true);

      return (
        <div className="screen bg-[#111] flex flex-col items-center justify-center px-6 text-white animate-fadeIn">
          {showParticles && <GoldParticles containerRef={containerRef} />}
          <div className="text-6xl mb-6">ğŸ†</div>
          <h1 className="text-2xl font-bold mb-2">ëŒ€ë‹¨í•´ìš”!</h1>
          <p className="text-gray-400 mb-6">ëª¨ë“  ë¬¸ì œë¥¼ í’€ì—ˆì–´ìš”</p>
          <div className="card mb-8 text-center w-full">
            <p className="text-amber-400 text-2xl font-bold">ğŸª™ 10mg íšë“!</p>
          </div>
          <button className="btn-primary" onClick={onNext}>
            ê¸ˆ ì €ì¥í•˜ê¸°
          </button>
        </div>
      );
    };

    // ë¡œê·¸ì¸ í™”ë©´
    const LoginScreen = ({ onLogin }) => (
      <div className="screen bg-[#111] flex flex-col items-center justify-center px-6 text-white animate-fadeIn">
        <div className="text-5xl mb-6">ğŸ”</div>
        <h1 className="text-xl font-bold mb-2">ê¸ˆê³ ì˜ ì—´ì‡ ë¥¼ ë§Œë“œì„¸ìš”</h1>
        <p className="text-gray-400 mb-8 text-center">ê°€ì…í•˜ë©´ íšë“í•œ ê¸ˆì´ ì €ì¥ë©ë‹ˆë‹¤</p>

        <button className="w-full p-4 rounded-xl bg-white text-black font-medium mb-3 flex items-center justify-center gap-3" onClick={onLogin}>
          <span className="text-lg">G</span> Googleë¡œ ê³„ì†í•˜ê¸°
        </button>
        <button className="w-full p-4 rounded-xl bg-black border border-gray-700 text-white font-medium mb-3 flex items-center justify-center gap-3" onClick={onLogin}>
          <span>ğŸ</span> Appleë¡œ ê³„ì†í•˜ê¸°
        </button>
        <button className="w-full p-4 rounded-xl bg-[#2A2A2A] text-white font-medium flex items-center justify-center gap-3" onClick={onLogin}>
          <span>âœ‰ï¸</span> ì´ë©”ì¼ë¡œ ê³„ì†í•˜ê¸°
        </button>
      </div>
    );

    // ë ˆí¼ëŸ´ ì½”ë“œ ì…ë ¥ í™”ë©´ (PRD ê¸°ë°˜)
    const ReferralScreen = ({ onComplete, onSkip }) => {
      const [code, setCode] = useState('');
      const [error, setError] = useState('');
      const [success, setSuccess] = useState(false);

      const handleSubmit = () => {
        // ì½”ë“œ í˜•ì‹ ê²€ì¦: GOLD-XXXXXX (6ìë¦¬)
        const codePattern = /^GOLD-[A-Z0-9]{6}$/i;
        if (!codePattern.test(code.toUpperCase())) {
          setError('ì˜¬ë°”ë¥¸ í˜•ì‹ì´ ì•„ë‹ˆì—ìš”. GOLD-XXXXXX í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
          return;
        }
        setError('');
        setSuccess(true);
        setTimeout(() => onComplete(true), 1500);
      };

      const handleCodeChange = (e) => {
        let value = e.target.value.toUpperCase();
        // ìë™ìœ¼ë¡œ GOLD- ì ‘ë‘ì‚¬ ì¶”ê°€
        if (value.length > 0 && !value.startsWith('GOLD-')) {
          if (value.length <= 6) {
            value = 'GOLD-' + value;
          }
        }
        setCode(value);
        setError('');
      };

      return (
        <div className="screen bg-[#111] flex flex-col px-6 text-white animate-fadeIn">
          <div className="p-4 flex justify-between items-center -mx-6">
            <div></div>
            <button className="text-gray-400 text-sm" onClick={onSkip}>ê±´ë„ˆë›°ê¸°</button>
          </div>

          <div className="flex-1 flex flex-col items-center justify-center">
            <div className="text-5xl mb-6">ğŸ</div>
            <h1 className="text-xl font-bold mb-2">ì´ˆëŒ€ ì½”ë“œê°€ ìˆë‚˜ìš”?</h1>
            <p className="text-gray-400 mb-8 text-center text-sm">ì¹œêµ¬ì˜ ì´ˆëŒ€ ì½”ë“œë¥¼ ì…ë ¥í•˜ë©´<br/>ì¶”ê°€ ë³´ìƒì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”
            </p>

            <div className="text-xs text-gray-500 text-center mb-2">6ìë¦¬ ì½”ë“œ ì…ë ¥</div>
            <div className="w-full mb-4">
              <input
                type="text"
                className="w-full bg-[#2A2A2A] p-4 rounded-xl text-center text-xl font-mono outline-none focus:ring-2 focus:ring-amber-500 uppercase"
                placeholder="GOLD-XXXXXX"
                value={code}
                onChange={handleCodeChange}
                maxLength={11}
              />
              {error && <p className="text-red-400 text-sm mt-2 text-center">{error}</p>}
            </div>

            {success ? (
              <div className="bg-green-500/20 text-green-400 p-4 rounded-xl w-full text-center animate-popIn mb-4">
                <span className="text-2xl">ğŸ‰</span>
                <p className="font-medium mt-2">ì½”ë“œ ì ìš© ì™„ë£Œ!</p>
                <p className="text-sm">ì¶”ê°€ ë³´ìƒì´ ì§€ê¸‰ë©ë‹ˆë‹¤</p>
              </div>
            ) : (
              <>
                <button
                  className="btn-primary mb-3 w-full"
                  onClick={handleSubmit}
                  disabled={code.length < 11}
                >
                  í™•ì¸
                </button>
                <button
                  className="w-full py-3 rounded-xl bg-transparent text-gray-400 font-medium text-sm hover:text-gray-300 transition-colors"
                  onClick={onSkip}
                >
                  ê±´ë„ˆë›°ê¸°
                </button>
              </>
            )}
          </div>

          <div className="pb-8 text-center">
            <p className="text-xs text-gray-500">
              ğŸ’¡ ì´ˆëŒ€ ì½”ë“œëŠ” ì¹œêµ¬ ì´ˆëŒ€ í™”ë©´ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”
            </p>
          </div>
        </div>
      );
    };

    // ë‹‰ë„¤ì„ ì„¤ì • í™”ë©´ (ì˜¨ë³´ë”©)
    const NicknameScreen = ({ onComplete }) => {
      const [name, setName] = useState('');
      const [error, setError] = useState('');

      const validateNickname = (value) => {
        if (value.length < 2) return 'ë‹‰ë„¤ì„ì€ 2ì ì´ìƒì´ì–´ì•¼ í•´ìš”';
        if (value.length > 10) return 'ë‹‰ë„¤ì„ì€ 10ì ì´í•˜ì—¬ì•¼ í•´ìš”';
        if (/[^a-zA-Z0-9ê°€-í£_]/.test(value)) return 'í•œê¸€, ì˜ë¬¸, ìˆ«ì, _ë§Œ ì‚¬ìš© ê°€ëŠ¥í•´ìš”';
        return '';
      };

      const handleSubmit = () => {
        const validationError = validateNickname(name);
        if (validationError) {
          setError(validationError);
          return;
        }
        onComplete(name);
      };

      return (
        <div className="screen bg-[#111] text-white flex flex-col">
          <div className="flex-1 flex flex-col items-center justify-center p-6">
            <div className="text-6xl mb-6">ğŸ‘¤</div>
            <h2 className="text-2xl font-bold mb-2">ë‹‰ë„¤ì„ì„ ì„¤ì •í•´ì£¼ì„¸ìš”</h2>
            <p className="text-gray-400 text-center mb-8">
              ì¹œêµ¬ë“¤ì—ê²Œ ë³´ì—¬ì§ˆ ì´ë¦„ì´ì—ìš”<br/>
              ë‚˜ì¤‘ì— ì„¤ì •ì—ì„œ ë³€ê²½í•  ìˆ˜ ìˆì–´ìš”
            </p>

            <div className="w-full max-w-xs mb-6">
              <input
                type="text"
                className="w-full bg-[#2A2A2A] p-4 rounded-xl text-center text-lg outline-none focus:ring-2 focus:ring-amber-500"
                placeholder="ë‹‰ë„¤ì„ ì…ë ¥ (2~10ì)"
                value={name}
                onChange={(e) => {
                  setName(e.target.value);
                  setError('');
                }}
                maxLength={10}
              />
              {error && <p className="text-red-400 text-sm mt-2 text-center">{error}</p>}
            </div>

            <button
              className="btn-primary w-full max-w-xs"
              onClick={handleSubmit}
              disabled={name.length < 2}
            >
              ì‹œì‘í•˜ê¸°
            </button>

            <p className="text-xs text-gray-500 mt-4 text-center">
              ğŸ’¡ 2~10ì, í•œê¸€/ì˜ë¬¸/ìˆ«ì/_ ì‚¬ìš© ê°€ëŠ¥
            </p>
          </div>
        </div>
      );
    };

    // ===== ë©”ì¸ í™”ë©´ë“¤ =====

    // í™ˆ í™”ë©´
    const HomeScreen = ({ userData, onMine, onHarvest, onNavigate, containerRef }) => {
      const { goldBalance, usdcBalance, miningStatus, cooldownTime, currentLevel } = userData;
      const [countdown, setCountdown] = useState(cooldownTime);
      const [showHarvestParticles, setShowHarvestParticles] = useState(false);

      useEffect(() => {
        setCountdown(cooldownTime);
      }, [cooldownTime]);

      useEffect(() => {
        if (miningStatus === 'mining' && countdown > 0) {
          const timer = setInterval(() => {
            setCountdown(c => {
              if (c <= 1) {
                clearInterval(timer);
                return 0;
              }
              return c - 1;
            });
          }, 1000);
          return () => clearInterval(timer);
        }
      }, [miningStatus]);

      const handleHarvest = () => {
        setShowHarvestParticles(true);
        onHarvest();
        setTimeout(() => setShowHarvestParticles(false), 2500);
      };

      const getMiningUI = () => {
        if (miningStatus === 'ready') {
          return {
            badge: <span className="badge badge-green">ì‹œì‘ ê°€ëŠ¥</span>,
            message: "ê¸ˆì„ ìºëŸ¬ ê°€ë³¼ê¹Œìš”?",
            button: <button className="btn-primary" onClick={onMine}>â›ï¸ ê¸ˆ ìºê¸° ì‹œì‘</button>
          };
        } else if (miningStatus === 'mining' && countdown > 0) {
          return {
            badge: <span className="badge badge-blue">ì±„êµ´ ì¤‘</span>,
            message: `${formatTime(countdown)} í›„ ê¸ˆì„ ìˆ˜í™•í•  ìˆ˜ ìˆì–´ìš”`,
            button: <button className="btn-primary" disabled>ì±„êµ´ ì¤‘...</button>
          };
        } else {
          return {
            badge: <span className="badge badge-gold">ìˆ˜í™• ê°€ëŠ¥</span>,
            message: "ê¸ˆì´ ì¤€ë¹„ë˜ì—ˆì–´ìš”!",
            button: <button className="btn-primary" onClick={handleHarvest}>ğŸŒ¾ ê¸ˆ ìˆ˜í™•í•˜ê¸°</button>
          };
        }
      };

      const miningUI = getMiningUI();

      return (
        <div className="screen bg-[#111] text-white pb-20">
          {showHarvestParticles && <GoldParticles containerRef={containerRef} />}

          <div className="p-4 flex justify-between items-center">
            <span className="text-xl font-bold text-amber-400">Lair Cash</span>
            <button onClick={() => onNavigate('settings')} className="text-xl">âš™ï¸</button>
          </div>

          <div className="px-4">
            {/* ì”ê³  ì¹´ë“œ */}
            <div className="card mb-4">
              <div className="flex justify-between mb-4">
                <div>
                  <p className="text-gray-400 text-sm">ğŸ’µ ë‹¬ëŸ¬ ì”ê³ </p>
                  <p className="text-2xl font-bold">${usdcBalance.toFixed(2)}</p>
                  <p className="text-xs text-gray-500">USDC</p>
                </div>
                <div className="text-right">
                  <p className="text-gray-400 text-sm">ğŸª™ ê¸ˆ ì”ê³ </p>
                  <p className="text-2xl font-bold text-amber-400">{goldBalance.toFixed(1)}mg</p>
                </div>
              </div>
              <div className="flex gap-3">
                <button className="flex-1 py-3 rounded-xl bg-[#2A2A2A] font-medium hover:bg-[#333] transition-colors" onClick={() => onNavigate('receive')}>
                  ë°›ê¸°
                </button>
                <button className="flex-1 py-3 rounded-xl bg-[#2A2A2A] font-medium hover:bg-[#333] transition-colors" onClick={() => onNavigate('send')}>
                  ë³´ë‚´ê¸°
                </button>
              </div>
            </div>

            {/* ê¸ˆìºê¸° ê²Œì„ ì¹´ë“œ */}
            <div className="card mb-4">
              <div className="flex justify-between items-center mb-4">
                <span className="font-medium">â›ï¸ ê¸ˆ ìºê¸° ê²Œì„</span>
                {miningUI.badge}
              </div>
              <div className="text-center py-4">
                <div className="text-4xl mb-3">â›ï¸</div>
                <p className="text-gray-400 mb-4">{miningUI.message}</p>
                {miningUI.button}
              </div>
              {currentLevel >= 5 && (
                <div className="mt-3 bg-amber-500/20 text-amber-400 text-sm p-2 rounded-lg text-center">
                  âš¡ Lv.5 ì±„êµ´ëŸ‰ 5ë°° ë¶€ìŠ¤íŠ¸ ì ìš© ì¤‘
                </div>
              )}
            </div>

            {/* ë°°í‹€íŒ¨ìŠ¤ ë°°ë„ˆ */}
            <div className="card mb-4 cursor-pointer hover:border-amber-500/50 transition-colors" onClick={() => onNavigate('friends')}>
              <div className="flex items-center gap-3">
                <span className="text-2xl">ğŸ‘¥</span>
                <div className="flex-1">
                  <p className="font-medium">ì¹œêµ¬ ì´ˆëŒ€í•˜ë©´ ì±„êµ´ëŸ‰ 5ë°°</p>
                  <p className="text-sm text-amber-400">+ ìµœëŒ€ 34mg ë³´ìƒ â†’</p>
                </div>
              </div>
            </div>

            {/* ë‹¬ëŸ¬ë¡œ ê¸ˆìºê¸° ì¹´ë“œ */}
            <div
              className="card mb-4 cursor-pointer hover:border-amber-500/50 transition-colors active:bg-[#252525]"
              onClick={() => onNavigate('dollarMining')}
            >
              <div className="flex justify-between items-center">
                <div>
                  <p className="font-medium">ğŸ’° ë‹¬ëŸ¬ë¡œ ê¸ˆìºê¸°</p>
                  <p className="text-sm text-gray-400">$10,000 ì˜ˆì¹˜ ì‹œ ì˜ˆìƒ</p>
                  <p className="text-sm text-amber-400">+15.3mg/ì¼</p>
                </div>
                <span className="text-gray-400 text-xl">â†’</span>
              </div>
            </div>

            {/* Coming Soon */}
            <div className="card opacity-50">
              <div className="flex justify-between items-center">
                <p className="font-medium">ğŸ”„ ê¸ˆ ì‚¬ê³ íŒ”ê¸°</p>
                <span className="badge badge-gray">Coming Soon</span>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // ì¹œêµ¬ ì´ˆëŒ€ & ë°°í‹€íŒ¨ìŠ¤ í™”ë©´
    const FriendsScreen = ({ userData, friends, onNudge, onClaimReward, onNavigate, onInviteFriend, containerRef, isPhoneVerified = false }) => {
      const { currentXP, claimedLevels, totalNudgeXP } = userData;
      const [showClaimModal, setShowClaimModal] = useState(null);
      const [showClaimParticles, setShowClaimParticles] = useState(false);
      const [copiedCode, setCopiedCode] = useState(false);
      const [nudgeToast, setNudgeToast] = useState(null);
      const [nudgeSuccessBanner, setNudgeSuccessBanner] = useState(null);
      const [nudgedFriends, setNudgedFriends] = useState(new Set());

      const currentLevel = getCurrentLevel(currentXP);
      const currentLevelData = BATTLEPASS_LEVELS[currentLevel - 1] || BATTLEPASS_LEVELS[0];
      const prevCumulativeXP = getCumulativeXP(currentLevel - 1);
      const currentLevelProgress = Math.max(0, currentXP - prevCumulativeXP);
      const progressPercent = Math.min(100, (currentLevelProgress / currentLevelData.xpRequired) * 100);

      const totalRewardsClaimed = BATTLEPASS_LEVELS
        .filter((_, i) => claimedLevels.includes(i + 1))
        .reduce((sum, l) => sum + l.reward, 0);

      const handleClaimClick = (level) => {
        const cumXP = getCumulativeXP(level);
        if (currentXP >= cumXP && !claimedLevels.includes(level)) {
          setShowClaimModal(level);
        }
      };

      const confirmClaim = () => {
        const level = showClaimModal;
        setShowClaimModal(null);
        setShowClaimParticles(true);
        onClaimReward(level);
        setTimeout(() => setShowClaimParticles(false), 2500);
      };

      const handleCopyCode = () => {
        setCopiedCode(true);
        setTimeout(() => setCopiedCode(false), 2000);
      };

      const getFriendStatusUI = (friend) => {
        const today = new Date().toDateString();
        const nudgedToday = friend.lastNudge === today;

        // PRD ê¸°ë°˜ ì¹œêµ¬ ìƒíƒœ UI
        if (nudgedToday) {
          return { text: "âœ… ì˜¤ëŠ˜ ì°”ë €ì–´ìš”", canNudge: false, color: "text-gray-400", badge: "badge-gray" };
        }
        switch (friend.status) {
          case 'cooldown_ready':
            return { text: "â° ì¿¨íƒ€ì„ì™„ë£Œ", canNudge: true, color: "text-amber-400", badge: "badge-gold" };
          case 'harvestable':
            return { text: "ğŸŒ¾ ìˆ˜í™•ê°€ëŠ¥", canNudge: false, color: "text-green-400", badge: "badge-green" };
          case 'mining':
            return { text: "â›ï¸ ê¸ˆìºê¸°ì¤‘", canNudge: false, color: "text-blue-400", badge: "badge-blue" };
          case 'cooldown_in_progress':
            return { text: "â³ ì¿¨íƒ€ì„ì¤‘", canNudge: false, color: "text-gray-400", badge: "badge-gray" };
          default:
            return { text: "â³ ì¿¨íƒ€ì„ì¤‘", canNudge: false, color: "text-gray-400", badge: "badge-gray" };
        }
      };

      return (
        <div className="screen bg-[#111] text-white pb-20 relative">
          {showClaimParticles && <GoldParticles containerRef={containerRef} />}

          {nudgeSuccessBanner && (
            <div className="banner-top whitespace-pre-line">
              {nudgeSuccessBanner}
            </div>
          )}

          <div className="p-4 flex items-center gap-3">
            <button onClick={() => onNavigate('home')} className="text-xl">â†</button>
            <span className="text-xl font-bold">ì¹œêµ¬ ì´ˆëŒ€</span>
          </div>

          <div className="px-4">
            {/* ë°°í‹€íŒ¨ìŠ¤ ì¹´ë“œ */}
            <div className="card mb-4 relative">
              {/* ë¯¸ì¸ì¦ ì‹œ ë°°í‹€íŒ¨ìŠ¤ ì ê¸ˆ ì˜¤ë²„ë ˆì´ */}
              {!isPhoneVerified && (
                <div className="absolute inset-0 bg-black/80 rounded-xl flex flex-col items-center justify-center z-10 p-4">
                  <div className="text-4xl mb-3">ğŸ”’</div>
                  <h3 className="font-bold text-lg mb-2">ë°°í‹€íŒ¨ìŠ¤ ì ê¸ˆ</h3>
                  <p className="text-gray-400 text-sm text-center mb-4">ì „í™”ë²ˆí˜¸ ì¸ì¦ í›„<br/>ë³´ìƒì„ ë°›ì„ ìˆ˜ ìˆì–´ìš”</p>
                  <button
                    onClick={() => onNavigate('phone-input')}
                    className="bg-amber-500 text-black font-bold py-2 px-6 rounded-lg"
                  >
                    ì „í™”ë²ˆí˜¸ ì¸ì¦í•˜ê¸°
                  </button>
                </div>
              )}

              <div className="flex justify-between items-center mb-3">
                <div className="flex items-center gap-2">
                  <span>â›ï¸</span>
                  <span className="font-bold text-amber-400">Lv.{currentLevel}</span>
                </div>
                <span className="text-sm text-gray-400">{totalRewardsClaimed}mg/34mg</span>
              </div>

              <div className="progress-bar mb-2">
                <div className="progress-fill" style={{ width: `${progressPercent}%` }}></div>
              </div>
              <p className="text-sm text-gray-400 text-right mb-4">
                {currentXP} / {getCumulativeXP(currentLevel)} XP
              </p>

              {currentLevel >= 5 && (
                <div className="bg-amber-500/20 text-amber-400 text-sm p-2 rounded-lg mb-4 text-center">
                  âš¡ ì±„êµ´ëŸ‰ 5ë°° ì ìš© ì¤‘
                </div>
              )}

              {/* ë ˆë²¨ ë¡œë“œë§µ */}
              <div className="flex justify-between gap-1 overflow-x-auto pb-2">
                {BATTLEPASS_LEVELS.map((level, i) => {
                  const cumXP = getCumulativeXP(i + 1);
                  const isUnlocked = currentXP >= cumXP;
                  const isClaimed = claimedLevels.includes(i + 1);

                  return (
                    <div
                      key={i}
                      className={`level-dot ${isClaimed ? 'claimed' : isUnlocked ? 'unlockable' : 'locked'}`}
                      onClick={() => isPhoneVerified && handleClaimClick(i + 1)}
                      title={`Lv.${i + 1}: ${level.reward}mg`}
                    >
                      {isClaimed ? 'âœ“' : i + 1}
                    </div>
                  );
                })}
              </div>
            </div>

            {/* XP íšë“ ë°©ë²• */}
            <div className="card mb-4">
              <h3 className="font-medium mb-3 text-gray-300">XP íšë“ ë°©ë²•</h3>
              <div className="space-y-2">
                <div
                  className="flex justify-between items-center py-2 px-2 rounded-lg hover:bg-white/5 cursor-pointer active:bg-white/10"
                  onClick={() => {/* ìŠ¤í¬ë¡¤ to ì´ˆëŒ€ ì„¹ì…˜ - ê°™ì€ í˜ì´ì§€ */}}
                >
                  <span className="text-sm">ğŸ‘¥ ì¹œêµ¬ ì´ˆëŒ€</span>
                  <span className="text-amber-400 text-sm">+50 XP/1ëª… â†’</span>
                </div>
                <div
                  className="flex justify-between items-center py-2 px-2 rounded-lg hover:bg-white/5 cursor-pointer active:bg-white/10"
                  onClick={() => onNavigate('receive')}
                >
                  <span className="text-sm">ğŸ’° ë‹¬ëŸ¬ ì…ê¸ˆ</span>
                  <span className="text-amber-400 text-sm">+5 XP/$1 â†’</span>
                </div>
                <div className="flex justify-between items-center py-2 px-2 rounded-lg hover:bg-white/5 cursor-pointer">
                  <span className="text-sm">ğŸ‘† Nudge ë°œì†¡</span>
                  <span className="text-amber-400 text-sm">+1 XP â†’</span>
                </div>
                <div className="flex justify-between items-center py-2 px-2 rounded-lg hover:bg-white/5 cursor-pointer">
                  <span className="text-sm">âœ… Nudge ì„±ê³µ</span>
                  <span className="text-amber-400 text-sm">+3 XP â†’</span>
                </div>
              </div>
            </div>

            {/* ì¹œêµ¬ì—ê²Œ ê¸ˆ ì„ ë¬¼í•˜ê¸° */}
            <div className="card mb-4">
              <h3 className="font-medium mb-2">ğŸ ì¹œêµ¬ì—ê²Œ ê¸ˆ ì„ ë¬¼í•˜ê¸°</h3>
              <p className="text-sm text-gray-400 mb-4">
                ì¹œêµ¬ë¥¼ ì´ˆëŒ€í•˜ë©´ ê°€ì…í•œ ì¹œêµ¬ë„, ë‚˜ë„ ê¸ˆ 1mgì”©!
              </p>
              <div className="flex items-center gap-2 mb-3">
                <code className="flex-1 bg-[#2A2A2A] p-3 rounded-lg text-amber-400 text-center">GOLD-ABC123</code>
                <button className="btn-small" onClick={handleCopyCode}>
                  {copiedCode ? 'âœ“' : 'ë³µì‚¬'}
                </button>
              </div>
              <button className="btn-primary" onClick={onInviteFriend}>ğŸ“¨ ì´ˆëŒ€ ë§í¬ ê³µìœ </button>
              <p className="text-xs text-gray-500 mt-2 text-center">
                ğŸ’¡ ë§í¬ê°€ ì•ˆ ë˜ë©´ ì½”ë“œë¥¼ ì§ì ‘ ì…ë ¥í•´ë‹¬ë¼ê³  ì•ˆë‚´
              </p>
            </div>

            {/* ë‚´ ì¹œêµ¬ë“¤ ì„¹ì…˜ (UI Option B) */}
            <div className="card">
              <div className="flex items-center gap-2 mb-4">
                <h3 className="font-medium">ğŸ‘¥ {friends.length}ëª…ì˜ ì¹œêµ¬</h3>
                <span className="text-gray-500">Â·</span>
                <span className="text-amber-400 text-sm">{totalNudgeXP} XP íšë“</span>
              </div>

              {friends.length === 0 ? (
                <div className="text-center py-8 text-gray-400">
                  <div className="text-5xl mb-4">ğŸ‘¥</div>
                  <p className="font-medium text-white mb-2">ì•„ì§ ì¹œêµ¬ê°€ ì—†ì–´ìš”</p>
                  <p className="text-sm mb-4">ì¹œêµ¬ë¥¼ ì´ˆëŒ€í•˜ë©´ ì„œë¡œ ê¸ˆìºê¸°<br/>í˜„í™©ì„ í™•ì¸í•˜ê³  ì½• ì°Œë¥¼ ìˆ˜ ìˆì–´ìš”!</p>
                  <button className="btn-primary py-2 px-4 text-sm" onClick={onInviteFriend}>
                    ğŸ“¨ ì§€ê¸ˆ ì´ˆëŒ€í•˜ê¸°
                  </button>
                </div>
              ) : (
                <div>
                  {friends.map(friend => {
                    const statusUI = getFriendStatusUI(friend);
                    return (
                      <div key={friend.id} className="friend-row">
                        <div className="flex items-center gap-3">
                          <span className="text-2xl">ğŸ‘¤</span>
                          <div>
                            <p className="font-medium">{friend.name}</p>
                            <span className={`badge ${statusUI.badge} text-xs`}>
                              {statusUI.text}
                            </span>
                          </div>
                        </div>
                        {statusUI.canNudge && (
                          <button
                            className={`btn-small ${nudgedFriends.has(friend.id) ? 'opacity-50 cursor-not-allowed' : ''}`}
                            disabled={nudgedFriends.has(friend.id)}
                            onClick={() => {
                              onNudge(friend.id);
                              // Show success toast
                              const friendName = friend.name;
                              setNudgeToast(`ğŸ‘† +1 XP íšë“!\n${friendName}ë‹˜ì—ê²Œ ì•Œë¦¼ ë°œì†¡`);
                              setNudgedFriends(new Set([...nudgedFriends, friend.id]));
                              // Simulate friend starting mining after 3 seconds
                              setTimeout(() => {
                                setNudgeSuccessBanner(`ğŸ‰ ${friendName}ë‹˜ì´ ê¸ˆìºê¸° ì‹œì‘!\n+3 XP íšë“!`);
                                setTimeout(() => setNudgeSuccessBanner(null), 3000);
                              }, 3000);
                            }}
                          >
                            {nudgedFriends.has(friend.id) ? 'ğŸ‘† ì°”ë €ì–´ìš”' : 'ğŸ‘† ì½• ì°Œë¥´ê¸°'}
                          </button>
                        )}
                      </div>
                    );
                  })}
                </div>
              )}
            </div>
          </div>

          {/* ë³´ìƒ í•´ê¸ˆ ëª¨ë‹¬ */}
          {showClaimModal && (
            <Modal onClose={() => setShowClaimModal(null)}>
              <div className="text-5xl mb-4">ğŸ‰</div>
              <h3 className="text-xl font-bold text-white mb-2">Lv.{showClaimModal} ë‹¬ì„±!</h3>
              <p className="text-amber-400 text-lg mb-6">
                ğŸª™ {BATTLEPASS_LEVELS[showClaimModal - 1].reward}mg íšë“!
              </p>
              <div className="flex gap-3">
                <button className="flex-1 py-3 rounded-xl bg-[#2A2A2A] text-white" onClick={() => setShowClaimModal(null)}>
                  ë‹«ê¸°
                </button>
                <button className="flex-1 btn-primary" onClick={confirmClaim}>
                  ë°›ê¸°
                </button>
              </div>
            </Modal>
          )}

          {/* Nudge ë°œì†¡ ì„±ê³µ í† ìŠ¤íŠ¸ */}
          {nudgeToast && (
            <div className="toast whitespace-pre-line">
              {nudgeToast}
            </div>
          )}
        </div>
      );
    };

    // ì„¤ì • í™”ë©´
    const SettingsScreen = ({ onNavigate, onLogout, isPhoneVerified = false, nickname = '', onNicknameChange }) => {
      const [pushNotifications, setPushNotifications] = useState(true);
      const [editingNickname, setEditingNickname] = useState(false);
      const [newNickname, setNewNickname] = useState(nickname);
      const [nicknameError, setNicknameError] = useState('');

      const validateNickname = (value) => {
        if (value.length < 2) return 'ë‹‰ë„¤ì„ì€ 2ì ì´ìƒì´ì–´ì•¼ í•´ìš”';
        if (value.length > 10) return 'ë‹‰ë„¤ì„ì€ 10ì ì´í•˜ì—¬ì•¼ í•´ìš”';
        if (/[^a-zA-Z0-9ê°€-í£_]/.test(value)) return 'í•œê¸€, ì˜ë¬¸, ìˆ«ì, _ë§Œ ì‚¬ìš© ê°€ëŠ¥í•´ìš”';
        return '';
      };

      const handleNicknameSave = () => {
        const error = validateNickname(newNickname);
        if (error) {
          setNicknameError(error);
          return;
        }
        onNicknameChange(newNickname);
        setEditingNickname(false);
        setNicknameError('');
      };

      return (
      <div className="screen bg-[#111] text-white pb-20">
        <div className="p-4 flex items-center gap-3">
          <button onClick={() => onNavigate('home')} className="text-xl">â†</button>
          <span className="text-xl font-bold">ì„¤ì •</span>
        </div>

        <div className="px-4">
          <div className="card mb-4">
            <h3 className="text-sm text-gray-500 mb-2">ê³„ì • ì •ë³´</h3>
            <p className="flex items-center gap-2 mb-2">ğŸ“§ user@email.com</p>

            {/* ë‹‰ë„¤ì„ ì„¹ì…˜ */}
            {editingNickname ? (
              <div className="mt-3 pt-3 border-t border-gray-700">
                <div className="flex items-center gap-2">
                  <span>ğŸ‘¤</span>
                  <input
                    type="text"
                    className="flex-1 bg-[#2A2A2A] p-2 rounded-lg text-sm outline-none focus:ring-2 focus:ring-amber-500"
                    value={newNickname}
                    onChange={(e) => {
                      setNewNickname(e.target.value);
                      setNicknameError('');
                    }}
                    maxLength={10}
                    placeholder="ë‹‰ë„¤ì„ ì…ë ¥"
                  />
                  <button className="btn-small text-xs py-1 px-3" onClick={handleNicknameSave}>ì €ì¥</button>
                  <button className="text-gray-400 text-sm" onClick={() => {
                    setEditingNickname(false);
                    setNewNickname(nickname);
                    setNicknameError('');
                  }}>ì·¨ì†Œ</button>
                </div>
                {nicknameError && <p className="text-red-400 text-xs mt-2 ml-6">{nicknameError}</p>}
              </div>
            ) : (
              <div
                className="flex items-center justify-between mt-3 pt-3 border-t border-gray-700 cursor-pointer hover:bg-white/5 rounded-lg px-2 -mx-2 py-2"
                onClick={() => setEditingNickname(true)}
              >
                <span className="flex items-center gap-2">ğŸ‘¤ {nickname || 'ë‹‰ë„¤ì„ ë¯¸ì„¤ì •'}</span>
                <span className="text-gray-400 text-sm">ë³€ê²½ â†’</span>
              </div>
            )}
          </div>

          <div className="card mb-4">
            <h3 className="text-sm text-gray-500 mb-3">ì„œë¹„ìŠ¤</h3>
            <div className="space-y-3">
              <div className="flex justify-between items-center py-2">
                <span>ğŸ”” í‘¸ì‹œ ì•Œë¦¼</span>
                <div className={`toggle-switch ${pushNotifications ? 'on' : ''}`} onClick={() => setPushNotifications(!pushNotifications)}>
                  <div className="toggle-switch-knob"></div>
                </div>
              </div>
              <div
                className="flex justify-between items-center py-2 cursor-pointer hover:bg-white/5 rounded-lg px-2 -mx-2"
                onClick={() => onNavigate('tutorial')}
              >
                <span>ğŸ“š íŠœí† ë¦¬ì–¼</span>
                <span className="text-gray-400">â†’</span>
              </div>
            </div>
          </div>

          <div className="card mb-4">
            <h3 className="text-sm text-gray-500 mb-3">ì•± ì •ë³´</h3>
            <div className="space-y-1">
              <div className="flex justify-between items-center py-2 cursor-pointer hover:bg-white/5 rounded-lg px-2 -mx-2">
                <span>ğŸ“„ ì´ìš©ì•½ê´€</span>
                <span className="text-gray-400">â†’</span>
              </div>
              <div className="flex justify-between items-center py-2 cursor-pointer hover:bg-white/5 rounded-lg px-2 -mx-2">
                <span>ğŸ”’ ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</span>
                <span className="text-gray-400">â†’</span>
              </div>
              <div className="flex justify-between items-center py-2 px-2 -mx-2">
                <span>ğŸ“± ì•± ë²„ì „</span>
                <span className="text-gray-400">v1.0.0</span>
              </div>
            </div>
          </div>

          <div className="card mb-4">
            <h3 className="text-sm text-gray-500 mb-3">ì§€ì›</h3>
            <div className="flex justify-between items-center py-2 cursor-pointer hover:bg-white/5 rounded-lg px-2 -mx-2">
              <span>ğŸ’¬ ê³ ê°ì„¼í„°</span>
              <span className="text-gray-400">â†’</span>
            </div>
          </div>

          <div className="card mb-4">
            <h3 className="text-sm text-gray-500 mb-3">ë³´ì•ˆ</h3>
            <div
              className="flex justify-between items-center py-2 cursor-pointer hover:bg-white/5 rounded-lg px-2 -mx-2"
              onClick={() => onNavigate('phone-input')}
            >
              <span>{isPhoneVerified ? 'âœ… ì „í™”ë²ˆí˜¸ ì¸ì¦' : 'ğŸ” ì „í™”ë²ˆí˜¸ ì¸ì¦'}</span>
              <span className="text-gray-400">â†’</span>
            </div>
          </div>

          <div className="card">
            <h3 className="text-sm text-gray-500 mb-3">ê³„ì • ê´€ë¦¬</h3>
            <div className="space-y-1">
              <div className="flex justify-between items-center py-2 cursor-pointer hover:bg-white/5 rounded-lg px-2 -mx-2" onClick={onLogout}>
                <span>ğŸšª ë¡œê·¸ì•„ì›ƒ</span>
                <span className="text-gray-400">â†’</span>
              </div>
              <div className="flex justify-between items-center py-2 cursor-pointer hover:bg-red-500/10 rounded-lg px-2 -mx-2 text-red-400">
                <span>ğŸ—‘ï¸ ê³„ì • ì‚­ì œ</span>
                <span>â†’</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    );
    };

    // ë°›ê¸° í™”ë©´
    const ReceiveScreen = ({ onNavigate }) => {
      const [guideView, setGuideView] = useState(null); // null, 'main', 'upbit', 'bithumb'
      const [copied, setCopied] = useState(false);

      const walletAddress = "0x1234567890abcdef1234567890abcdef12345678";

      const handleCopy = () => {
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
      };

      // ê±°ë˜ì†Œ ìƒì„¸ ê°€ì´ë“œ í™”ë©´
      if (guideView === 'upbit' || guideView === 'bithumb') {
        return (
          <ExchangeDetailGuide
            exchange={guideView}
            walletAddress={walletAddress}
            onBack={() => setGuideView('main')}
          />
        );
      }

      // ê±°ë˜ì†Œ ì…ê¸ˆ ê°€ì´ë“œ ë©”ì¸ (íŠ¸ë˜ë¸”ë£° + ê±°ë˜ì†Œ ì„ íƒ)
      if (guideView === 'main') {
        return (
          <div className="screen bg-[#111] text-white pb-4 overflow-y-auto">
            <div className="p-4 flex items-center gap-3">
              <button onClick={() => setGuideView(null)} className="text-xl">â†</button>
              <span className="text-xl font-bold">ê±°ë˜ì†Œì—ì„œ ì…ê¸ˆí•˜ê¸°</span>
            </div>

            <div className="px-4">
              {/* íŠ¸ë˜ë¸”ë£° ì•ˆë‚´ */}
              <div className="card mb-4">
                <h3 className="font-medium mb-3">ğŸ“‹ íŠ¸ë˜ë¸”ë£°ì´ë€?</h3>
                <p className="text-sm text-gray-400 mb-3">
                  í•œêµ­ ê±°ë˜ì†Œì—ì„œ ê°€ìƒìì‚°ì„ ì™¸ë¶€ ì§€ê°‘ìœ¼ë¡œ ì¶œê¸ˆí•  ë•Œ, ìê¸ˆì„¸íƒë°©ì§€ë¥¼ ìœ„í•´ <span className="text-amber-400">ì¶œê¸ˆ ì£¼ì†Œ ì‚¬ì „ ë“±ë¡</span>ì´ í•„ìš”í•©ë‹ˆë‹¤.
                </p>
                <div className="bg-[#2A2A2A] rounded-lg p-3 text-sm">
                  <div className="flex justify-between py-1 border-b border-gray-700">
                    <span className="text-gray-400">ì¶œê¸ˆ ê¸ˆì•¡</span>
                    <span className="text-gray-400">ì—…ë¹„íŠ¸</span>
                    <span className="text-gray-400">ë¹—ì¸</span>
                  </div>
                  <div className="flex justify-between py-2 border-b border-gray-700">
                    <span>100ë§Œì› ë¯¸ë§Œ</span>
                    <span className="text-amber-400">1:1 ë¬¸ì˜</span>
                    <span className="text-green-400">ì§ì ‘ ë“±ë¡</span>
                  </div>
                  <div className="flex justify-between py-2">
                    <span>100ë§Œì› ì´ìƒ</span>
                    <span className="text-red-400">âŒ ë¶ˆê°€</span>
                    <span className="text-green-400">âœ… ê°€ëŠ¥</span>
                  </div>
                </div>
              </div>

              {/* ê±°ë˜ì†Œ ì„ íƒ */}
              <h3 className="font-medium mb-3">ğŸ“– ê±°ë˜ì†Œë³„ ê°€ì´ë“œ</h3>

              <button
                className="card w-full flex items-center gap-4 mb-3 hover:border-amber-500/50 transition-colors"
                onClick={() => setGuideView('upbit')}
              >
                <div className="w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center text-xl font-bold">U</div>
                <div className="text-left flex-1">
                  <p className="font-medium">ì—…ë¹„íŠ¸</p>
                  <span className="badge bg-amber-500/20 text-amber-400 text-xs">âš ï¸ 100ë§Œì› ë¯¸ë§Œë§Œ</span>
                </div>
                <span className="text-gray-400">â†’</span>
              </button>

              <button
                className="card w-full flex items-center gap-4 mb-4 hover:border-amber-500/50 transition-colors"
                onClick={() => setGuideView('bithumb')}
              >
                <div className="w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center text-xl font-bold">B</div>
                <div className="text-left flex-1">
                  <p className="font-medium">ë¹—ì¸</p>
                  <span className="badge bg-green-500/20 text-green-400 text-xs">âœ… 100ë§Œì› ì´ìƒ ê°€ëŠ¥</span>
                </div>
                <span className="text-gray-400">â†’</span>
              </button>

              {/* ê³µí†µ ìœ ì˜ì‚¬í•­ */}
              <div className="p-3 bg-amber-500/10 border border-amber-500/30 rounded-lg">
                <p className="text-sm text-amber-400">
                  âš ï¸ <span className="font-bold">ë„¤íŠ¸ì›Œí¬ëŠ” ë°˜ë“œì‹œ Ethereum (ERC20)</span>ì„ ì„ íƒí•˜ì„¸ìš”. ë‹¤ë¥¸ ë„¤íŠ¸ì›Œí¬ ì„ íƒ ì‹œ ìì‚° ë³µêµ¬ê°€ ë¶ˆê°€í•©ë‹ˆë‹¤.
                </p>
              </div>
            </div>
          </div>
        );
      }

      // ê¸°ë³¸ ë°›ê¸° í™”ë©´
      return (
        <div className="screen bg-[#111] text-white">
          <div className="p-4 flex items-center gap-3">
            <button onClick={() => onNavigate('home')} className="text-xl">â†</button>
            <span className="text-xl font-bold">ë°›ê¸°</span>
          </div>

          <div className="px-4 text-center">
            {/* ì„œë¹„ìŠ¤ ì •ë³´ (íŠ¸ë˜ë¸”ë£° ì¦ë¹™ìš©) */}
            <div className="card mb-4 py-4">
              <div className="w-16 h-16 bg-gradient-to-br from-amber-400 to-amber-600 rounded-full mx-auto mb-2 flex items-center justify-center text-2xl font-bold text-black">
                LC
              </div>
              <p className="font-medium">Lair Cash</p>
            </div>

            <div className="badge badge-blue mb-4">Ethereum</div>

            <div className="card mb-4">
              <div className="w-40 h-40 bg-white mx-auto mb-4 rounded-lg flex items-center justify-center">
                <div className="grid grid-cols-5 gap-1 p-2">
                  {[...Array(25)].map((_, i) => (
                    <div key={i} className={`w-5 h-5 ${Math.random() > 0.5 ? 'bg-black' : 'bg-white'}`}></div>
                  ))}
                </div>
              </div>
              <p className="text-xs text-gray-400 break-all px-2">
                {walletAddress}
              </p>
            </div>

            <button className="btn-primary mb-3" onClick={handleCopy}>
              {copied ? 'âœ“ ë³µì‚¬ë¨' : 'ì£¼ì†Œ ë³µì‚¬'}
            </button>

            <button
              className="w-full py-3 rounded-xl bg-[#2A2A2A] font-medium mb-4 hover:bg-[#333] transition-colors"
              onClick={() => setGuideView('main')}
            >
              ğŸ“– ê±°ë˜ì†Œì—ì„œ ì…ê¸ˆí•˜ê¸°
            </button>

            <p className="text-sm text-amber-400">âš ï¸ USDCë§Œ ì§€ì›ë©ë‹ˆë‹¤</p>
            <p className="text-xs text-gray-500 mt-2">ğŸ’¡ ì´ í™”ë©´ì„ ìº¡ì³í•˜ì—¬ ê±°ë˜ì†Œ ì‹¬ì‚¬ì— ì œì¶œí•˜ì„¸ìš”</p>
          </div>
        </div>
      );
    };

    // ê±°ë˜ì†Œ ìƒì„¸ ê°€ì´ë“œ í™”ë©´ (PRD ê¸°ë°˜ ì™„ì „ ì¬êµ¬í˜„)
    const ExchangeDetailGuide = ({ exchange, walletAddress, onBack }) => {
      const [currentStep, setCurrentStep] = useState(0);
      const [copied, setCopied] = useState(false);

      const handleCopy = () => {
        setCopied(true);
        setTimeout(() => setCopied(false), 2000);
      };

      const guides = {
        upbit: {
          name: 'ì—…ë¹„íŠ¸',
          limitBadge: { text: 'âš ï¸ 100ë§Œì› ë¯¸ë§Œë§Œ ê°€ëŠ¥', style: 'bg-amber-500/20 text-amber-400' },
          steps: [
            {
              title: 'ì¶œê¸ˆì£¼ì†Œ ë“±ë¡ ì‹ ì²­',
              desc: 'PC: [ê³ ê°ì„¼í„°] â†’ [1:1 ë¬¸ì˜í•˜ê¸°] â†’ [ì¼ë°˜] â†’ [ì¶œê¸ˆì£¼ì†Œ ë“±ë¡ ì‹ ì²­]\n\nëª¨ë°”ì¼: [ë”ë³´ê¸°] â†’ [ê³ ê°ì„¼í„°] â†’ [1:1 ë¬¸ì˜í•˜ê¸°] â†’ [ì¼ë°˜] â†’ [ì¶œê¸ˆì£¼ì†Œ ë“±ë¡ ì‹ ì²­]',
              icon: 'ğŸ“',
              path: '[ê³ ê°ì„¼í„°] â†’ [1:1 ë¬¸ì˜í•˜ê¸°] â†’ [ì¶œê¸ˆì£¼ì†Œ ë“±ë¡ ì‹ ì²­]'
            },
            {
              title: 'ì¦ë¹™ ìë£Œ ì œì¶œ',
              desc: 'Lair Cash ì•±ì˜ "ë°›ê¸°" í™”ë©´ ìº¡ì³ ì œì¶œ',
              icon: 'ğŸ“¸',
              tip: 'ğŸ’¡ ë¡œê³  + ì£¼ì†Œ + ë„¤íŠ¸ì›Œí¬ê°€ ëª¨ë‘ ë³´ì´ëŠ” 1ì¥ì´ë©´ ì¶©ë¶„'
            },
            {
              title: 'ìŠ¹ì¸ ëŒ€ê¸°',
              desc: 'ìœ ê´€ ë¶€ì„œ ê²€í†  í›„ ìˆœì°¨ ì²˜ë¦¬',
              icon: 'â³',
              warning: 'âš ï¸ ë¯¸ì‹ ê³  ê±°ë˜ì†Œ í™•ì¸ ê³¼ì •ì—ì„œ ì‹œê°„ ì†Œìš” ê°€ëŠ¥'
            },
            {
              title: 'ì¶œê¸ˆ ì§„í–‰',
              desc: 'ìŠ¹ì¸ ì™„ë£Œ í›„ USDC ì¶œê¸ˆ',
              icon: 'âœ…',
              warning: 'âš ï¸ ë„¤íŠ¸ì›Œí¬: ì´ë”ë¦¬ì›€(ERC20) í•„ìˆ˜ ì„ íƒ',
              showAddress: true
            }
          ],
          footer: 'âš ï¸ 100ë§Œì› ì´ìƒì€ ì—°ë™ ì§€ê°‘ë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤. Lair CashëŠ” ê°œì¸ì§€ê°‘ìœ¼ë¡œ ë¶„ë¥˜ë˜ì–´ 100ë§Œì› ì´ìƒ ì¶œê¸ˆì´ ë¶ˆê°€í•©ë‹ˆë‹¤.'
        },
        bithumb: {
          name: 'ë¹—ì¸',
          limitBadge: { text: 'âœ… 100ë§Œì› ì´ìƒë„ ê°€ëŠ¥', style: 'bg-green-500/20 text-green-400' },
          steps: [
            {
              title: 'ì¶œê¸ˆì£¼ì†Œ ë“±ë¡',
              desc: 'PC/ëª¨ë°”ì¼: [ì…ì¶œê¸ˆ] â†’ [ì£¼ì†Œë¡] â†’ [ì£¼ì†Œ ë“±ë¡]',
              icon: 'ğŸ“',
              path: '[ì…ì¶œê¸ˆ] â†’ [ì£¼ì†Œë¡] â†’ [ì£¼ì†Œ ë“±ë¡]'
            },
            {
              title: 'ê±°ë˜ì†Œ/ì§€ê°‘ ì„ íƒ',
              desc: '[ê·¸ ì™¸ ê±°ë˜ì†Œ] ì„ íƒ',
              icon: 'ğŸ¦',
              tip: 'ğŸ’¡ Lair CashëŠ” í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì—†ìœ¼ë¯€ë¡œ "ê·¸ ì™¸" ì„ íƒ'
            },
            {
              title: 'ì •ë³´ ì…ë ¥',
              desc: 'ì¶œê¸ˆí•  ê°€ìƒìì‚°: USDC\në„¤íŠ¸ì›Œí¬: Ethereum (ERC20)\nì§€ê°‘ ì£¼ì†Œ: Lair Cash ì£¼ì†Œ ì…ë ¥',
              icon: 'âœï¸'
            },
            {
              title: 'ì¦ë¹™ ì—…ë¡œë“œ',
              desc: 'Lair Cash "ë°›ê¸°" í™”ë©´ ìº¡ì³ ì—…ë¡œë“œ',
              icon: 'ğŸ“¸',
              tip: 'ğŸ’¡ ë¡œê³  + ì£¼ì†Œê°€ ë³´ì´ëŠ” 1ì¥ì´ë©´ ì¶©ë¶„'
            },
            {
              title: 'ì¶œê¸ˆ ì§„í–‰',
              desc: 'ê´€ë¦¬ì ì‹¬ì‚¬ ìŠ¹ì¸ í›„ ì¶œê¸ˆ ê°€ëŠ¥',
              icon: 'âœ…',
              warning: 'âš ï¸ ë„¤íŠ¸ì›Œí¬: Ethereum (ERC20) í•„ìˆ˜ ì„ íƒ',
              showAddress: true
            }
          ],
          footer: 'ğŸ’¡ ë¹—ì¸ì€ ì¦ë¹™ ì œì¶œ ì‹œ 100ë§Œì› ì´ìƒë„ ì¶œê¸ˆ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì‹¬ì‚¬ì— 1~3 ì˜ì—…ì¼ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.'
        }
      };

      const guide = guides[exchange];
      const step = guide.steps[currentStep];

      return (
        <div className="screen bg-[#111] text-white pb-4 overflow-y-auto">
          <div className="p-4 flex items-center gap-3">
            <button onClick={onBack} className="text-xl">â†</button>
            <span className="text-xl font-bold">{guide.name} ì¶œê¸ˆ ê°€ì´ë“œ</span>
          </div>

          <div className="px-4">
            {/* ì œí•œ ë°°ì§€ */}
            <div className={`inline-block px-3 py-1 rounded-full text-sm font-medium mb-4 ${guide.limitBadge.style}`}>
              {guide.limitBadge.text}
            </div>

            {/* ì§„í–‰ë¥  */}
            <div className="flex gap-1 mb-4">
              {guide.steps.map((_, i) => (
                <div
                  key={i}
                  className={`flex-1 h-1 rounded-full ${i <= currentStep ? 'bg-amber-500' : 'bg-gray-700'}`}
                />
              ))}
            </div>

            {/* í˜„ì¬ ë‹¨ê³„ ì¹´ë“œ */}
            <div className="card mb-4 animate-fadeIn" key={currentStep}>
              <div className="flex items-start gap-3 mb-3">
                <div className="w-8 h-8 bg-amber-500 rounded-full flex items-center justify-center text-black font-bold text-sm flex-shrink-0">
                  {currentStep + 1}
                </div>
                <div>
                  <h3 className="font-bold text-lg">{step.title}</h3>
                </div>
              </div>

              {step.path && (
                <div className="bg-[#2A2A2A] p-2 rounded-lg text-xs font-mono text-gray-300 mb-3">
                  {step.path}
                </div>
              )}

              <p className="text-gray-400 text-sm whitespace-pre-line mb-3">{step.desc}</p>

              {step.tip && (
                <div className="bg-green-500/10 border border-green-500/30 p-2 rounded-lg mb-3">
                  <p className="text-sm text-green-400">{step.tip}</p>
                </div>
              )}

              {step.warning && (
                <div className="bg-amber-500/10 border border-amber-500/30 p-2 rounded-lg mb-3">
                  <p className="text-sm text-amber-400">{step.warning}</p>
                </div>
              )}

              {step.showAddress && (
                <div className="bg-[#2A2A2A] p-3 rounded-lg">
                  <p className="text-xs text-gray-500 mb-2">Lair Cash ì…ê¸ˆ ì£¼ì†Œ</p>
                  <p className="text-xs text-amber-400 break-all font-mono mb-2">{walletAddress}</p>
                  <button className="btn-small w-full" onClick={handleCopy}>
                    {copied ? 'âœ“ ë³µì‚¬ë¨' : 'ì£¼ì†Œ ë³µì‚¬'}
                  </button>
                </div>
              )}
            </div>

            {/* ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ */}
            <div className="flex gap-3 mb-4">
              {currentStep > 0 && (
                <button
                  className="flex-1 py-3 rounded-xl bg-[#2A2A2A] font-medium"
                  onClick={() => setCurrentStep(currentStep - 1)}
                >
                  ì´ì „
                </button>
              )}
              {currentStep < guide.steps.length - 1 ? (
                <button
                  className="flex-1 btn-primary"
                  onClick={() => setCurrentStep(currentStep + 1)}
                >
                  ë‹¤ìŒ
                </button>
              ) : (
                <button className="flex-1 btn-primary" onClick={onBack}>
                  ì™„ë£Œ
                </button>
              )}
            </div>

            {/* í•˜ë‹¨ ì•ˆë‚´ */}
            <div className={`p-3 rounded-lg ${exchange === 'upbit' ? 'bg-amber-500/10 border border-amber-500/30' : 'bg-green-500/10 border border-green-500/30'}`}>
              <p className={`text-sm ${exchange === 'upbit' ? 'text-amber-400' : 'text-green-400'}`}>
                {guide.footer}
              </p>
            </div>
          </div>
        </div>
      );
    };

    // ë‹¬ëŸ¬ë¡œ ê¸ˆìºê¸° í™”ë©´ (PRD ê¸°ë°˜)
    const DollarMiningScreen = ({ userData, onNavigate }) => {
      const [selectedProduct, setSelectedProduct] = useState(null);
      const [selectedDeposit, setSelectedDeposit] = useState(null);
      const [depositAmount, setDepositAmount] = useState('');
      const [showDepositModal, setShowDepositModal] = useState(false);
      const [showWithdrawModal, setShowWithdrawModal] = useState(false);

      // PRD ê¸°ë°˜ ìƒí’ˆ ì •ë³´ (ëª¨ì§‘ ì¤‘ ìƒí’ˆ)
      const products = [
        {
          id: 4,
          name: 'ê¸ˆìºê¸° 4ì°¨',
          status: 'recruiting',
          apy: '5%',
          maturityDays: 30,
          maturityDate: '2026-03-10',
          goldType: 'ê¸ˆ(XAUT)',
          recruitedAmount: 32000,
          targetAmount: 50000,
          recruitEndTime: '3ì¼ 12ì‹œê°„ 34ë¶„',
          description: 'ë‹¬ëŸ¬ë¡œ ê¸ˆ ìºê¸°',
          badge: 'ğŸŸ¢ ëª¨ì§‘ ì¤‘',
          availableAmount: 1500
        },
        {
          id: 2,
          name: 'ê¸ˆìºê¸° 2ì°¨',
          status: 'operating',
          apy: '4.5%',
          daysRemaining: 5,
          description: 'ìš´ì˜ ì¤‘ì¸ ìƒí’ˆ',
          badge: 'ğŸ”µ ìš´ìš© ì¤‘'
        },
        {
          id: 0,
          name: 'ê¸ˆìºê¸° 0ì°¨',
          status: 'closed',
          dateRange: '2026-01-01~01-15',
          totalGoldDispatched: 1245.8,
          description: 'ì¢…ë£Œëœ ìƒí’ˆ',
          badge: 'â¬œ ì¢…ë£Œ'
        }
      ];

      // ë‚´ ì˜ˆì¹˜ í˜„í™© (ë°ëª¨ ë°ì´í„°)
      const myDeposits = [
        {
          id: 'deposit_1',
          productName: 'ê¸ˆìºê¸° 1ì°¨',
          status: 'operating',
          badge: 'ğŸ”µ ìš´ìš© ì¤‘',
          depositAmount: 500,
          startDate: '2026-01-09',
          maturityDate: '2026-02-08',
          currentGold: 120.5,
          expectedTotal: 150.2,
          daysRemaining: 12,
          interestHistory: [
            { date: '2/3', gold: 6.72 },
            { date: '2/2', gold: 6.72 },
            { date: '2/1', gold: 6.72 }
          ]
        },
        {
          id: 'deposit_3',
          productName: 'ê¸ˆìºê¸° 3ì°¨',
          status: 'matured',
          badge: 'âœ… ë§Œê¸°ì™„ë£Œ',
          depositAmount: 300,
          earnedGold: 90.3,
          maturityDate: '2026-02-08'
        }
      ];

      const handleProductClick = (product) => {
        if (product.status === 'recruiting') {
          setSelectedProduct(product);
        }
      };

      const handleDepositClick = (deposit) => {
        setSelectedDeposit(deposit);
      };

      const handleDeposit = () => {
        setShowDepositModal(true);
      };

      const handleWithdraw = () => {
        setShowWithdrawModal(true);
      };

      const confirmDeposit = () => {
        // ì…ê¸ˆ ì²˜ë¦¬ ë¡œì§
        setShowDepositModal(false);
        setSelectedProduct(null);
        setDepositAmount('');
      };

      const confirmWithdraw = () => {
        // ì¶œê¸ˆ ì²˜ë¦¬ ë¡œì§
        setShowWithdrawModal(false);
        setSelectedDeposit(null);
      };

      // ë‚´ ì˜ˆì¹˜ ìƒì„¸ í™”ë©´ (ìš´ìš© ì¤‘)
      if (selectedDeposit && selectedDeposit.status === 'operating') {
        return (
          <div className="screen bg-[#111] text-white pb-20 animate-fadeIn">
            <div className="p-4 flex items-center gap-3 border-b border-gray-800">
              <button onClick={() => setSelectedDeposit(null)} className="text-xl">â†</button>
              <span className="text-lg font-bold">{selectedDeposit.productName} (ë‚´ ì˜ˆì¹˜)</span>
            </div>

            <div className="px-4 py-4">
              {/* ìƒíƒœ ë°°ì§€ */}
              <div className="mb-4">
                <span className="badge badge-blue">{selectedDeposit.badge}</span>
              </div>

              {/* ì˜ˆì¹˜ í˜„í™© */}
              <div className="card mb-4">
                <h3 className="font-medium mb-3">ë‚´ ì˜ˆì¹˜ í˜„í™©</h3>
                <div className="space-y-3">
                  <div className="flex justify-between py-2">
                    <span className="text-gray-400">ì˜ˆì¹˜ ì›ê¸ˆ</span>
                    <span className="text-white font-medium">${selectedDeposit.depositAmount}</span>
                  </div>
                  <div className="flex justify-between py-2">
                    <span className="text-gray-400">í˜„ì¬ ì´ì</span>
                    <span className="text-amber-400 font-medium">{selectedDeposit.currentGold}mg</span>
                  </div>
                  <div className="flex justify-between py-2 border-t border-gray-700 pt-2">
                    <span className="text-gray-400">ë§Œê¸° ì˜ˆìƒ</span>
                    <span className="text-amber-400 font-bold">{selectedDeposit.expectedTotal}mg</span>
                  </div>
                  <div className="flex justify-between py-2">
                    <span className="text-gray-400">ë§Œê¸°ê¹Œì§€</span>
                    <span className="text-white">D-{selectedDeposit.daysRemaining}</span>
                  </div>
                </div>
              </div>

              {/* ì´ì ì ë¦½ íˆìŠ¤í† ë¦¬ */}
              <div className="card mb-4">
                <h3 className="font-medium mb-3">ğŸ“ˆ ì´ì ì ë¦½ íˆìŠ¤í† ë¦¬</h3>
                <div className="space-y-2">
                  {selectedDeposit.interestHistory.map((item, idx) => (
                    <div key={idx} className="flex justify-between py-2 text-sm">
                      <span className="text-gray-400">{item.date}</span>
                      <span className="text-amber-400">+{item.gold}mg</span>
                    </div>
                  ))}
                  <div className="text-center text-xs text-gray-500 py-2">...</div>
                </div>
              </div>
            </div>
          </div>
        );
      }

      // ë‚´ ì˜ˆì¹˜ ìƒì„¸ í™”ë©´ (ë§Œê¸° ì™„ë£Œ)
      if (selectedDeposit && selectedDeposit.status === 'matured') {
        return (
          <div className="screen bg-[#111] text-white pb-20 animate-fadeIn">
            <div className="p-4 flex items-center gap-3 border-b border-gray-800">
              <button onClick={() => setSelectedDeposit(null)} className="text-xl">â†</button>
              <span className="text-lg font-bold">{selectedDeposit.productName}</span>
            </div>

            <div className="px-4 py-4">
              {/* ìƒíƒœ ë°°ì§€ */}
              <div className="mb-4">
                <span className="badge badge-gray">{selectedDeposit.badge}</span>
              </div>

              {/* ì¶œê¸ˆ ì •ë³´ */}
              <div className="card mb-4">
                <h3 className="font-medium mb-3">ğŸ‰ ì¶œê¸ˆ ê°€ëŠ¥</h3>
                <div className="space-y-3">
                  <div className="flex justify-between py-2">
                    <span className="text-gray-400">ì˜ˆì¹˜ ì›ê¸ˆ</span>
                    <span className="text-white font-medium">ğŸ’µ ${selectedDeposit.depositAmount}</span>
                  </div>
                  <div className="flex justify-between py-2 border-t border-gray-700 pt-2">
                    <span className="text-gray-400">ì´ ì´ì</span>
                    <span className="text-amber-400 font-bold">ğŸª™ {selectedDeposit.earnedGold}mg</span>
                  </div>
                </div>
              </div>

              <button
                className="btn-primary w-full"
                onClick={handleWithdraw}
              >
                ì›ê¸ˆ + ì´ì ì¶œê¸ˆ
              </button>
            </div>

            {/* ì¶œê¸ˆ í™•ì¸ ëª¨ë‹¬ */}
            {showWithdrawModal && (
              <Modal onClose={() => setShowWithdrawModal(false)}>
                <div className="text-5xl mb-4">ğŸ‰</div>
                <h3 className="text-lg font-bold text-white mb-4">ì¶œê¸ˆ í™•ì¸</h3>
                <div className="space-y-3 mb-4">
                  <p className="text-gray-300 text-sm">{selectedDeposit.productName}</p>
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-400">ğŸ’µ ì›ê¸ˆ</span>
                    <span className="text-white font-medium">${selectedDeposit.depositAmount}</span>
                  </div>
                  <div className="flex justify-between text-sm">
                    <span className="text-gray-400">ğŸª™ ì´ì</span>
                    <span className="text-amber-400 font-medium">{selectedDeposit.earnedGold}mg</span>
                  </div>
                </div>
                <div className="flex gap-3">
                  <button
                    className="flex-1 py-3 rounded-xl bg-[#2A2A2A] text-white font-medium"
                    onClick={() => setShowWithdrawModal(false)}
                  >
                    ì·¨ì†Œ
                  </button>
                  <button
                    className="flex-1 btn-primary"
                    onClick={confirmWithdraw}
                  >
                    ì¶œê¸ˆ
                  </button>
                </div>
              </Modal>
            )}
          </div>
        );
      }

      // ìƒí’ˆ ìƒì„¸ í™”ë©´ (ëª¨ì§‘ ì¤‘)
      if (selectedProduct && selectedProduct.status === 'recruiting') {
        const recruitPercent = (selectedProduct.recruitedAmount / selectedProduct.targetAmount) * 100;
        
        return (
          <div className="screen bg-[#111] text-white pb-20 animate-fadeIn">
            <div className="p-4 flex items-center gap-3 border-b border-gray-800">
              <button onClick={() => setSelectedProduct(null)} className="text-xl">â†</button>
              <span className="text-lg font-bold">{selectedProduct.name}</span>
            </div>

            <div className="px-4 py-4">
              {/* ìƒíƒœ ë°°ì§€ */}
              <div className="mb-4">
                <span className="badge badge-green">{selectedProduct.badge}</span>
              </div>

              {/* ìƒí’ˆ ì•„ì´ì½˜ ë° ì„¤ëª… */}
              <div className="card mb-4 text-center">
                <div className="text-5xl mb-3">ğŸª™</div>
                <p className="text-gray-300">{selectedProduct.description}</p>
                <p className="text-lg font-bold mt-2">{selectedProduct.name}</p>
              </div>

              {/* ìƒí’ˆ ì •ë³´ */}
              <div className="card mb-4">
                <h3 className="font-medium mb-3">ğŸ“Š ìƒí’ˆ ì •ë³´</h3>
                <div className="space-y-2 text-sm">
                  <div className="flex justify-between py-2">
                    <span className="text-gray-400">ì´ììœ¨</span>
                    <span className="text-white">ì—° {selectedProduct.apy} (ê³ ì •)</span>
                  </div>
                  <div className="flex justify-between py-2">
                    <span className="text-gray-400">ë§Œê¸°</span>
                    <span className="text-white">{selectedProduct.maturityDays}ì¼</span>
                  </div>
                  <div className="flex justify-between py-2">
                    <span className="text-gray-400">ë§Œê¸°ì¼</span>
                    <span className="text-white">{selectedProduct.maturityDate}</span>
                  </div>
                  <div className="flex justify-between py-2">
                    <span className="text-gray-400">ì´ì ì§€ê¸‰</span>
                    <span className="text-white">{selectedProduct.goldType}</span>
                  </div>
                </div>
              </div>

              {/* ëª¨ì§‘ í˜„í™© */}
              <div className="card mb-4">
                <h3 className="font-medium mb-3">ğŸ“ˆ ëª¨ì§‘ í˜„í™©</h3>
                <div className="progress-bar mb-2">
                  <div className="progress-fill" style={{ width: `${recruitPercent}%` }}></div>
                </div>
                <p className="text-sm text-gray-400 text-center">${selectedProduct.recruitedAmount.toLocaleString()} / ${selectedProduct.targetAmount.toLocaleString()}</p>
                <p className="text-xs text-gray-500 text-center mt-2">{recruitPercent.toFixed(0)}% ëª¨ì§‘ ì™„ë£Œ</p>
              </div>

              {/* ëª¨ì§‘ ë§ˆê° ì‹œê°„ */}
              <div className="card mb-4 bg-amber-500/10 border-amber-500/30">
                <p className="text-sm text-gray-300">â±ï¸ ëª¨ì§‘ ë§ˆê°ê¹Œì§€</p>
                <p className="text-lg font-bold text-amber-400 mt-1">{selectedProduct.recruitEndTime}</p>
              </div>

              {/* ì˜ˆì¹˜ ì…ë ¥ */}
              <div className="card mb-4">
                <h3 className="font-medium mb-3">ğŸ’° ì˜ˆì¹˜í•˜ê¸°</h3>
                <p className="text-xs text-gray-400 mb-3">ì˜ˆì¹˜ ê°€ëŠ¥ ê¸ˆì•¡: ${selectedProduct.availableAmount.toLocaleString()}</p>
                <div className="relative mb-3">
                  <span className="absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                  <input
                    type="number"
                    className="w-full bg-[#2A2A2A] p-4 pl-8 rounded-xl text-xl font-bold outline-none focus:ring-2 focus:ring-amber-500"
                    placeholder="0"
                    value={depositAmount}
                    onChange={(e) => setDepositAmount(e.target.value)}
                  />
                </div>
                <button
                  className="btn-small"
                  onClick={() => setDepositAmount(selectedProduct.availableAmount.toString())}
                >
                  MAX
                </button>
              </div>

              {/* ì˜ˆìƒ ìˆ˜ë ¹ */}
              {depositAmount && (
                <div className="card mb-4 bg-amber-500/10 border-amber-500/30">
                  <p className="text-sm text-gray-300">ë§Œê¸° ì‹œ ì˜ˆìƒ ìˆ˜ë ¹</p>
                  <p className="text-2xl font-bold text-amber-400 mt-2">
                    ğŸª™ {(Number(depositAmount) * 0.00082).toFixed(1)}mg
                  </p>
                </div>
              )}

              <button
                className="btn-primary w-full"
                onClick={handleDeposit}
                disabled={!depositAmount || Number(depositAmount) <= 0}
              >
                ì˜ˆì¹˜í•˜ê¸°
              </button>
            </div>

            {/* ì˜ˆì¹˜ í™•ì¸ ëª¨ë‹¬ */}
            {showDepositModal && (
              <Modal onClose={() => setShowDepositModal(false)}>
                <div className="text-5xl mb-4">ğŸª™</div>
                <h3 className="text-lg font-bold text-white mb-4">ì˜ˆì¹˜ í™•ì¸</h3>
                <div className="space-y-2 mb-4 text-sm">
                  <p className="text-gray-300">{selectedProduct.name}</p>
                  <div className="flex justify-between">
                    <span className="text-gray-400">ì˜ˆì¹˜ì•¡</span>
                    <span className="text-white font-bold">${depositAmount}</span>
                  </div>
                  <div className="flex justify-between text-amber-400">
                    <span>â†’</span>
                    <span className="font-bold">ğŸª™ {(Number(depositAmount) * 0.00082).toFixed(1)}mg ì˜ˆìƒ</span>
                  </div>
                </div>
                <div className="flex gap-3">
                  <button
                    className="flex-1 py-3 rounded-xl bg-[#2A2A2A] text-white font-medium text-sm"
                    onClick={() => setShowDepositModal(false)}
                  >
                    ì·¨ì†Œ
                  </button>
                  <button
                    className="flex-1 btn-primary text-sm"
                    onClick={confirmDeposit}
                  >
                    í™•ì¸
                  </button>
                </div>
              </Modal>
            )}
          </div>
        );
      }

      // ë©”ì¸ í™”ë©´ (ìƒí’ˆ ëª©ë¡)
      return (
        <div className="screen bg-[#111] text-white pb-20 animate-fadeIn">
          <div className="p-4 flex items-center gap-3 border-b border-gray-800">
            <button onClick={() => onNavigate('home')} className="text-xl">â†</button>
            <span className="text-lg font-bold">ğŸ’° ë‹¬ëŸ¬ë¡œ ê¸ˆìºê¸°</span>
          </div>

          <div className="px-4 py-4">
            {/* ë‚´ ì˜ˆì¹˜ í˜„í™© */}
            {myDeposits.length > 0 && (
              <div className="card mb-4">
                <h3 className="font-medium mb-3">ğŸ“ˆ ë‚´ ì˜ˆì¹˜ í˜„í™©</h3>
                {myDeposits.map((deposit, idx) => (
                  <div key={idx} className="bg-[#2A2A2A] rounded-xl p-3 mb-2">
                    <div className="flex justify-between items-start mb-2">
                      <span className="text-sm font-medium">{deposit.productName}</span>
                      <span className="badge badge-green text-xs">ìš´ìš©ì¤‘</span>
                    </div>
                    <div className="grid grid-cols-2 gap-2 text-xs">
                      <div>
                        <p className="text-gray-400">ì˜ˆì¹˜ ê¸ˆì•¡</p>
                        <p className="text-white">${deposit.depositAmount}</p>
                      </div>
                      <div>
                        <p className="text-gray-400">ë§Œê¸°ì¼</p>
                        <p className="text-white">{deposit.maturityDate}</p>
                      </div>
                      <div>
                        <p className="text-gray-400">íšë“ ê¸ˆ</p>
                        <p className="text-amber-400">+{deposit.earnedGold}mg</p>
                      </div>
                      <div>
                        <p className="text-gray-400">ë§Œê¸° ì˜ˆìƒ</p>
                        <p className="text-amber-400">+{deposit.expectedTotal}mg</p>
                      </div>
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* ë‹¬ëŸ¬ ì…ê¸ˆ ë²„íŠ¼ */}
            <div className="card mb-4 bg-gradient-to-r from-green-500/10 to-blue-500/10 border-green-500/30">
              <div className="flex items-center justify-between">
                <div>
                  <p className="font-medium">ğŸ’µ ë‹¬ëŸ¬ ì…ê¸ˆí•˜ê¸°</p>
                  <p className="text-sm text-gray-400">USDCë¡œ ì…ê¸ˆí•˜ê³  ê¸ˆì„ ìºì„¸ìš”</p>
                </div>
                <button
                  className="btn-small"
                  onClick={() => onNavigate('receive')}
                >
                  ì…ê¸ˆ â†’
                </button>
              </div>
            </div>

            {/* ì „ì²´ ìƒí’ˆ ëª©ë¡ */}
            <h3 className="font-medium mb-3">ğŸ¦ ì „ì²´ ìƒí’ˆ</h3>
            {products.map(product => (
              <div
                key={product.id}
                className={`card mb-3 cursor-pointer transition-all ${
                  product.status === 'recruiting'
                    ? 'hover:border-amber-500/50'
                    : 'opacity-50'
                }`}
                onClick={() => handleProductClick(product)}
              >
                <div className="flex justify-between items-start mb-3">
                  <div>
                    <span className="font-medium">{product.name}</span>
                    {product.badge && (
                      <span className={`ml-2 badge ${
                        product.status === 'recruiting' ? 'badge-gold' : 'badge-gray'
                      } text-xs`}>
                        {product.badge}
                      </span>
                    )}
                  </div>
                  <span className="text-gray-400">â†’</span>
                </div>
                <div className="flex justify-between text-sm">
                  <div>
                    <p className="text-gray-400">ì—° ìˆ˜ìµë¥ </p>
                    <p className="text-green-400 font-bold">{product.apy}</p>
                  </div>
                  <div className="text-right">
                    <p className="text-gray-400">ê¸ˆ ì´ììœ¨</p>
                    <p className="text-amber-400 font-medium">{product.goldRate}</p>
                  </div>
                </div>
                <p className="text-xs text-gray-500 mt-2">{product.description}</p>
              </div>
            ))}

            {/* ì•ˆë‚´ ë¬¸êµ¬ */}
            <div className="bg-[#1A1A1A] rounded-xl p-4 mt-4">
              <p className="text-xs text-gray-400">
                ğŸ’¡ ë‹¬ëŸ¬ë¡œ ê¸ˆìºê¸°ëŠ” USDCë¥¼ ì˜ˆì¹˜í•˜ê³  ê¸ˆ ì´ìë¥¼ ë°›ëŠ” ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.<br/>
                ì±„ê¶Œí˜• ìƒí’ˆì— íˆ¬ìë˜ì–´ ì•ˆì •ì ì¸ ìˆ˜ìµì„ ì¶”êµ¬í•©ë‹ˆë‹¤.
              </p>
            </div>
          </div>
        </div>
      );
    };

    // ë³´ë‚´ê¸° í™”ë©´
    const SendScreen = ({ userData, onNavigate }) => {
      const [amount, setAmount] = useState('');
      const [step, setStep] = useState(1);
      const [address, setAddress] = useState('');

      // ì „ì†¡ ì™„ë£Œ í™”ë©´
      if (step === 4) {
        return (
          <div className="screen bg-[#111] text-white flex flex-col items-center justify-center px-6 animate-fadeIn">
            <div className="text-6xl mb-6">âœ…</div>
            <h1 className="text-2xl font-bold mb-2">ì „ì†¡ ì™„ë£Œ!</h1>
            <p className="text-gray-400 mb-6 text-center">
              {amount} USDCê°€<br/>ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤
            </p>

            <div className="card w-full mb-6">
              <div className="flex justify-between py-2 border-b border-gray-700">
                <span className="text-gray-400 text-sm">ê¸ˆì•¡</span>
                <span className="font-medium">{amount} USDC</span>
              </div>
              <div className="flex justify-between py-2 border-b border-gray-700">
                <span className="text-gray-400 text-sm">ë°›ëŠ” ì£¼ì†Œ</span>
                <span className="text-sm">0x1234...5678</span>
              </div>
              <div className="flex justify-between py-2">
                <span className="text-gray-400 text-sm">íŠ¸ëœì­ì…˜</span>
                <span className="text-amber-400 text-sm">í™•ì¸í•˜ê¸° â†’</span>
              </div>
            </div>

            <button className="btn-primary w-full" onClick={() => onNavigate('home')}>
              í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°
            </button>
          </div>
        );
      }

      return (
        <div className="screen bg-[#111] text-white">
          <div className="p-4 flex items-center gap-3">
            <button onClick={() => step === 1 ? onNavigate('home') : setStep(step - 1)} className="text-xl">â†</button>
            <span className="text-xl font-bold">ë³´ë‚´ê¸°</span>
          </div>

          {step === 1 && (
            <div className="px-4 animate-fadeIn">
              <div className="card mb-6">
                <div className="flex items-center gap-2 mb-4">
                  <span className="text-xl">ğŸ’µ</span>
                  <span className="font-medium">USDC</span>
                </div>

                <input
                  type="number"
                  className="w-full bg-transparent text-4xl font-bold text-center outline-none mb-2"
                  placeholder="0"
                  value={amount}
                  onChange={(e) => setAmount(e.target.value)}
                />
                <p className="text-center text-gray-400">â‰ˆ ${amount || '0'}.00</p>
              </div>

              <div className="flex justify-between items-center mb-6 text-sm">
                <span className="text-gray-400">ë³´ìœ : {userData.usdcBalance.toFixed(2)} USDC</span>
                <button className="text-amber-400 font-medium" onClick={() => setAmount(userData.usdcBalance.toString())}>MAX</button>
              </div>

              <button
                className="btn-primary"
                disabled={!amount || parseFloat(amount) <= 0}
                onClick={() => setStep(2)}
              >
                ë‹¤ìŒ
              </button>
            </div>
          )}

          {step === 2 && (
            <div className="px-4 animate-fadeIn">
              <div className="card mb-6">
                <p className="text-gray-400 text-sm mb-2">ë°›ëŠ” ì£¼ì†Œ</p>
                <input
                  type="text"
                  className="w-full bg-[#2A2A2A] p-3 rounded-lg outline-none focus:ring-2 focus:ring-amber-500"
                  placeholder="0x..."
                  value={address}
                  onChange={(e) => setAddress(e.target.value)}
                />
              </div>

              <div className="flex gap-3 mb-6">
                <button className="flex-1 py-3 rounded-xl bg-[#2A2A2A] hover:bg-[#333] transition-colors">ğŸ“· QR ìŠ¤ìº”</button>
                <button className="flex-1 py-3 rounded-xl bg-[#2A2A2A] hover:bg-[#333] transition-colors" onClick={() => setAddress('0x1234567890abcdef1234567890abcdef12345678')}>ğŸ“‹ ë¶™ì—¬ë„£ê¸°</button>
              </div>

              <button className="btn-primary" onClick={() => setStep(3)}>
                ë‹¤ìŒ
              </button>
            </div>
          )}

          {step === 3 && (
            <div className="px-4 animate-fadeIn">
              <div className="text-center mb-6">
                <p className="text-4xl font-bold mb-2">{amount} USDC</p>
                <p className="text-gray-400">â‰ˆ ${amount}.00</p>
              </div>

              <div className="card mb-6">
                <div className="flex justify-between py-3 border-b border-gray-700">
                  <span className="text-gray-400">ë°›ëŠ” ì£¼ì†Œ</span>
                  <span>0x1234...5678</span>
                </div>
                <div className="flex justify-between py-3 border-b border-gray-700">
                  <span className="text-gray-400">ë„¤íŠ¸ì›Œí¬</span>
                  <span>Ethereum</span>
                </div>
                <div className="flex justify-between py-3">
                  <span className="text-gray-400">ê°€ìŠ¤ë¹„</span>
                  <span className="text-green-400">ë¬´ë£Œ (ê°€ìŠ¤ë¹„ ëŒ€ë‚©)</span>
                </div>
              </div>

              <div className="bg-blue-500/20 text-blue-400 p-3 rounded-lg mb-6 text-sm text-center">
                ğŸ’¡ ë‚¨ì€ ë¬´ë£Œ ì „ì†¡ í¬ë ˆë”§: 5 â†’ 4íšŒ
              </div>

              <button className="btn-primary mb-3" onClick={() => setStep(4)}>ë³´ë‚´ê¸°</button>
              <button className="btn-secondary w-full" onClick={() => onNavigate('home')}>ì·¨ì†Œ</button>
            </div>
          )}
        </div>
      );
    };

    // íŠœí† ë¦¬ì–¼ í™”ë©´ (ì„¤ì •ì—ì„œ ì§„ì…, PRD ê¸°ë°˜ - ê¸ˆ ë³´ìƒ ì—†ìŒ)
    const TutorialScreen = ({ onComplete }) => {
      const [step, setStep] = useState(0);

      const tutorialSteps = [
        {
          icon: "ğŸ’µ",
          title: "ë‹¬ëŸ¬ë¡œ ê¸ˆìºê¸°",
          desc: "USDC ë‹¬ëŸ¬ë¥¼ ì˜ˆì¹˜í•˜ë©´\në§¤ì¼ ìë™ìœ¼ë¡œ ê¸ˆì´ ìŒ“ì—¬ìš”"
        },
        {
          icon: "â›ï¸",
          title: "ê¸ˆ ìºê¸° ê²Œì„",
          desc: "ì¿¨íƒ€ì„ì´ ëë‚˜ë©´ ë²„íŠ¼ì„ ëˆŒëŸ¬\në¬´ë£Œë¡œ ê¸ˆì„ ìˆ˜í™•í•˜ì„¸ìš”"
        },
        {
          icon: "ğŸ‘¥",
          title: "ì¹œêµ¬ ì´ˆëŒ€",
          desc: "ì¹œêµ¬ë¥¼ ì´ˆëŒ€í•˜ë©´ ì±„êµ´ëŸ‰ì´ 5ë°°!\në°°í‹€íŒ¨ìŠ¤ë¡œ ìµœëŒ€ 34mg ë³´ìƒ"
        },
        {
          icon: "ğŸ‘†",
          title: "ì½• ì°Œë¥´ê¸°",
          desc: "ì¹œêµ¬ì˜ ì¿¨íƒ€ì„ì´ ëë‚˜ë©´\nì½• ì°”ëŸ¬ì„œ XPë¥¼ ë°›ìœ¼ì„¸ìš”"
        },
        {
          icon: "ğŸ‰",
          title: "ì¤€ë¹„ ì™„ë£Œ!",
          desc: "ì´ì œ Lair Cashì—ì„œ\nê¸ˆì„ ëª¨ì„ ì¤€ë¹„ê°€ ëì–´ìš”"
        }
      ];

      const currentStep = tutorialSteps[step];

      return (
        <div className="screen bg-[#111] text-white flex flex-col">
          <div className="p-4 flex items-center gap-3">
            <button onClick={onComplete} className="text-xl">â†</button>
            <span className="text-xl font-bold">íŠœí† ë¦¬ì–¼</span>
          </div>

          {/* ì§„í–‰ë¥  */}
          <div className="px-4 mb-4">
            <div className="flex gap-1">
              {tutorialSteps.map((_, i) => (
                <div
                  key={i}
                  className={`flex-1 h-1 rounded-full ${i <= step ? 'bg-amber-500' : 'bg-gray-700'}`}
                />
              ))}
            </div>
          </div>

          <div className="flex-1 flex flex-col items-center justify-center px-6 animate-fadeIn" key={step}>
            <div className="text-6xl mb-6">{currentStep.icon}</div>
            <h2 className="text-xl font-bold mb-3">{currentStep.title}</h2>
            <p className="text-gray-400 text-center whitespace-pre-line">{currentStep.desc}</p>
          </div>

          <div className="p-4">
            {step < tutorialSteps.length - 1 ? (
              <button className="btn-primary" onClick={() => setStep(step + 1)}>
                ë‹¤ìŒ
              </button>
            ) : (
              <button className="btn-primary" onClick={onComplete}>
                ì™„ë£Œ
              </button>
            )}
          </div>
        </div>
      );
    };

    // íœ´ëŒ€í° ì¸ì¦ í™”ë©´ 1: ì „í™”ë²ˆí˜¸ ì…ë ¥
    const PhoneVerificationScreen1 = ({ onNext, onNavigate }) => {
      const [phoneNumber, setPhoneNumber] = useState('010-');

      const handlePhoneChange = (e) => {
        let value = e.target.value.replace(/[^\d-]/g, '');
        if (value.length > 13) value = value.slice(0, 13);

        // Auto-format: 010-XXXX-XXXX
        if (value.length <= 3) {
          setPhoneNumber(value);
        } else if (value.length <= 7) {
          setPhoneNumber(value.slice(0, 3) + '-' + value.slice(3));
        } else {
          setPhoneNumber(value.slice(0, 3) + '-' + value.slice(3, 7) + '-' + value.slice(7));
        }
      };

      // ğŸ® ë°ëª¨ìš©: 3ìë¦¬ ì´ìƒ ì…ë ¥í•˜ë©´ í†µê³¼ (ì‹¤ì œëŠ” 10ìë¦¬ í•„ìš”)
      const isValid = phoneNumber.replace(/\D/g, '').length >= 3;

      return (
        <div className="screen bg-[#111] text-white flex flex-col">
          <div className="p-4 flex items-center gap-3">
            <button onClick={() => onNavigate('home')} className="text-xl">â†</button>
            <span className="text-xl font-bold">ì „í™”ë²ˆí˜¸ ì¸ì¦</span>
          </div>

          <div className="flex-1 flex flex-col justify-center px-6 pb-24">
            <div className="text-center mb-8">
              <p className="text-xl font-medium mb-4">ì „í™”ë²ˆí˜¸ë¥¼ ì¸ì¦í•´ì£¼ì„¸ìš”</p>
              <div className="bg-amber-500/20 border border-amber-500/30 rounded-lg p-4 text-sm text-gray-300">
                <p>âš ï¸ í•œ ë²ˆ ë“±ë¡í•˜ë©´</p>
                <p>ë³€ê²½í•  ìˆ˜ ì—†ì–´ìš”</p>
              </div>
            </div>

            <div className="mb-6">
              <div className="flex items-center gap-2 mb-4">
                <span className="text-xl">ğŸ‡°ğŸ‡·</span>
                <span className="text-gray-400">+82</span>
              </div>
              <input
                type="text"
                className="w-full bg-[#2A2A2A] p-4 rounded-xl outline-none focus:ring-2 focus:ring-amber-500 text-lg font-mono"
                placeholder="010-0000-0000"
                value={phoneNumber}
                onChange={handlePhoneChange}
              />
            </div>

            <button
              className="btn-primary"
              disabled={!isValid}
              onClick={() => {
                setPhoneNumber(phoneNumber);
                onNext('phone-otp');
              }}
            >
              ì¸ì¦ë²ˆí˜¸ ë°›ê¸°
            </button>
          </div>
        </div>
      );
    };

    // íœ´ëŒ€í° ì¸ì¦ í™”ë©´ 2: OTP ì…ë ¥
    const PhoneVerificationScreen2 = ({ phoneNumber: displayPhone, onNext, onNavigate }) => {
      const [otp, setOtp] = useState(['', '', '', '', '', '']);
      const [timeLeft, setTimeLeft] = useState(165); // 2:45
      const [resendDisabled, setResendDisabled] = useState(true);
      const otpInputs = useRef([]);

      useEffect(() => {
        const timer = setInterval(() => {
          setTimeLeft(t => {
            if (t <= 1) {
              clearInterval(timer);
              setResendDisabled(false);
              return 0;
            }
            return t - 1;
          });
        }, 1000);
        return () => clearInterval(timer);
      }, []);

      const handleOtpChange = (index, value) => {
        if (!/^\d?$/.test(value)) return;

        const newOtp = [...otp];
        newOtp[index] = value;
        setOtp(newOtp);

        // Auto-focus next input
        if (value && index < 5) {
          otpInputs.current[index + 1]?.focus();
        }
      };

      const handleKeyDown = (index, e) => {
        if (e.key === 'Backspace' && !otp[index] && index > 0) {
          otpInputs.current[index - 1]?.focus();
        }
      };

      // ğŸ® ë°ëª¨ìš©: 1ìë¦¬ë§Œ ì…ë ¥í•´ë„ í†µê³¼ (ì‹¤ì œëŠ” 6ìë¦¬ ëª¨ë‘ í•„ìš”)
      const isComplete = otp.some(digit => digit !== '');

      return (
        <div className="screen bg-[#111] text-white flex flex-col">
          <div className="p-4 flex items-center gap-3">
            <button onClick={() => onNavigate('phone-input')} className="text-xl">â†</button>
            <span className="text-xl font-bold">ì¸ì¦ë²ˆí˜¸ ì…ë ¥</span>
          </div>

          <div className="flex-1 flex flex-col justify-center px-6 pb-24">
            <div className="text-center mb-8">
              <p className="text-gray-400 mb-2">{displayPhone}ë¡œ</p>
              <p className="font-medium mb-4">ì¸ì¦ë²ˆí˜¸ë¥¼ ë³´ëƒˆì–´ìš”</p>
            </div>

            <div className="flex justify-center gap-2 mb-8">
              {otp.map((digit, i) => (
                <input
                  key={i}
                  ref={el => otpInputs.current[i] = el}
                  type="text"
                  maxLength="1"
                  className={`otp-input ${digit ? 'filled' : ''}`}
                  value={digit}
                  onChange={(e) => handleOtpChange(i, e.target.value)}
                  onKeyDown={(e) => handleKeyDown(i, e)}
                />
              ))}
            </div>

            <div className="text-center mb-6">
              <p className="countdown-timer">â±ï¸ {Math.floor(timeLeft / 60)}:{(timeLeft % 60).toString().padStart(2, '0')} ë‚¨ìŒ</p>
            </div>

            <div className="text-center mb-6">
              <p className="text-gray-400 text-sm mb-2">ì¸ì¦ë²ˆí˜¸ê°€ ì•ˆ ì™”ë‚˜ìš”?</p>
              <button
                className={`text-sm font-medium ${resendDisabled ? 'text-gray-500' : 'text-amber-400'}`}
                disabled={resendDisabled}
              >
                {resendDisabled ? `[ì¬ë°œì†¡] (${resendDisabled ? Math.floor((165 - timeLeft) / 1) + 'ì´ˆ í›„ í™œì„±í™”' : ''})` : '[ì¬ë°œì†¡]'}
              </button>
            </div>

            <button
              className="btn-primary"
              disabled={!isComplete}
              onClick={() => onNext('phone-success')}
            >
              ì¸ì¦í•˜ê¸°
            </button>
          </div>
        </div>
      );
    };

    // íœ´ëŒ€í° ì¸ì¦ í™”ë©´ 3: ì„±ê³µ ì˜¤ë²„ë ˆì´
    const PhoneVerificationSuccess = ({ onComplete }) => {
      useEffect(() => {
        const timer = setTimeout(onComplete, 2000);
        return () => clearTimeout(timer);
      }, [onComplete]);

      return (
        <div className="success-overlay">
          <div className="text-6xl mb-4 animate-popIn">âœ…</div>
          <h2 className="text-2xl font-bold text-white mb-2">ì¸ì¦ì´ ì™„ë£Œë˜ì—ˆì–´ìš”!</h2>
          <p className="text-gray-400 text-center">ì´ì œ ë°°í‹€íŒ¨ìŠ¤ê°€<br/>í™œì„±í™”ë©ë‹ˆë‹¤</p>
          <p className="text-xs text-gray-500 mt-4">(2ì´ˆ í›„ ìë™ ë‹«í˜)</p>
        </div>
      );
    };

    // ë°°í‹€íŒ¨ìŠ¤ ì ê¸ˆ í™”ë©´ (ì¸ì¦ ì „)
    const BattlepassLockedState = ({ onNavigate }) => (
      <div className="screen bg-[#111] text-white">
        <div className="p-4 flex items-center gap-3">
          <button onClick={() => onNavigate('home')} className="text-xl">â†</button>
          <span className="text-xl font-bold">ì¹œêµ¬ ì´ˆëŒ€</span>
        </div>

        <div className="locked-state px-6">
          <div className="text-5xl">ğŸ”’</div>
          <h2 className="text-2xl font-bold">ë°°í‹€íŒ¨ìŠ¤ ì ê¸ˆ</h2>
          <p className="text-gray-400 text-center">ì „í™”ë²ˆí˜¸ ì¸ì¦ í›„<br/>ë°°í‹€íŒ¨ìŠ¤ê°€ í™œì„±í™”ë©ë‹ˆë‹¤</p>
          <button
            className="btn-primary w-full mt-6"
            onClick={() => onNavigate('phone-input')}
          >
            ì „í™”ë²ˆí˜¸ ì¸ì¦í•˜ê¸°
          </button>
        </div>
      </div>
    );

    // ìˆ˜í™• ê²°ê³¼ ëª¨ë‹¬ (PRD ê¸°ë°˜: Lv.5 ë¹„êµ + CTA)
    const HarvestResultModal = ({ reward, currentLevel, nextCooldown, onClose, onLevelUp }) => {
      const isLevelFive = currentLevel >= 5;
      const formatCooldown = (seconds) => {
        if (seconds < 60) return `${seconds}ì´ˆ`;
        return `${Math.floor(seconds / 60)}ë¶„`;
      };

      return (
        <div className="modal-overlay">
          <div className="modal-content animate-popIn">
            <div className="text-5xl mb-4">ğŸª™</div>
            <h3 className="text-2xl font-bold text-amber-400 mb-2">+{reward}mg íšë“!</h3>

            {/* Lv.5 ë¹„êµ ë°•ìŠ¤ (ë ˆë²¨ 5 ë¯¸ë§Œì¼ ë•Œë§Œ í‘œì‹œ) */}
            {!isLevelFive && (
              <div className="bg-gradient-to-r from-purple-500/20 to-amber-500/20 border border-purple-500/30 rounded-xl p-4 mb-4 w-full">
                <p className="text-sm text-gray-300 mb-1">ğŸ’ Lv.5ë¼ë©´</p>
                <p className="text-lg font-bold text-amber-400">+0.5mg ë°›ì•˜ì„ ê±°ì˜ˆìš”</p>
                <p className="text-xs text-gray-400 mt-1">ì§€ê¸ˆë³´ë‹¤ 5ë°° ë”!</p>
              </div>
            )}

            {/* ë‹¤ìŒ ì¿¨íƒ€ì„ */}
            <div className="bg-[#2A2A2A] rounded-xl p-3 mb-4 w-full text-center">
              <p className="text-sm text-gray-400">
                â° ë‹¤ìŒ ìˆ˜í™•ê¹Œì§€ <span className="text-white font-medium">{formatCooldown(nextCooldown)}</span>
              </p>
            </div>

            <div className="flex gap-3 w-full">
              <button
                className="flex-1 py-3 rounded-xl bg-[#2A2A2A] text-white font-medium"
                onClick={onClose}
              >
                í™•ì¸
              </button>
              {!isLevelFive && (
                <button
                  className="flex-1 btn-primary"
                  onClick={onLevelUp}
                >
                  ğŸš€ ë ˆë²¨ì—…í•˜ê³  5ë°° ë°›ê¸°
                </button>
              )}
            </div>
          </div>
        </div>
      );
    };

    // Nudge ìˆ˜ì‹  íŒì—… (ì•± ì§„ì… ì‹œ, PRD ê¸°ë°˜)
    const NudgeReceivedPopup = ({ senderName, onClose, onStartMining }) => (
      <div className="modal-overlay">
        <div className="modal-content animate-popIn">
          <div className="text-5xl mb-4">ğŸ‘†</div>
          <h3 className="text-lg font-bold text-white mb-2">ì½•!</h3>
          <p className="text-gray-300 mb-4">
            {senderName}ë‹˜ì´ ë‹¹ì‹ ì„ ì½• ì°”ë €ì–´ìš”!<br/>
            ì§€ê¸ˆ ê¸ˆìºê¸°ë¥¼ ì‹œì‘í•˜ì„¸ìš”
          </p>
          <div className="flex gap-3">
            <button className="flex-1 py-3 rounded-xl bg-[#2A2A2A] text-white" onClick={onClose}>
              ë‚˜ì¤‘ì—
            </button>
            <button className="flex-1 btn-primary" onClick={onStartMining}>
              ê¸ˆ ìºëŸ¬ ê°€ê¸°
            </button>
          </div>
        </div>
      </div>
    );

    // ===== ë©”ì¸ ì•± =====
    const App = () => {
      const [screen, setScreen] = useState('intro');
      const [activeTab, setActiveTab] = useState('home');
      const [toast, setToast] = useState(null);
      const [showNudgePopup, setShowNudgePopup] = useState(false);
      const [nudgeSender, setNudgeSender] = useState('');
      const [showTutorial, setShowTutorial] = useState(false);
      const [miningCount, setMiningCount] = useState(0); // ì±„êµ´ íšŸìˆ˜ (ì¿¨íƒ€ì„ ê³„ì‚°ìš©)
      const [harvestResult, setHarvestResult] = useState(null); // ìˆ˜í™• ê²°ê³¼ ëª¨ë‹¬ ë°ì´í„°
      const [phoneVerificationStep, setPhoneVerificationStep] = useState(null); // null, 'phone-input', 'phone-otp', 'phone-success'
      const [phoneNumber, setPhoneNumber] = useState('');
      const [isPhoneVerified, setIsPhoneVerified] = useState(false);
      const containerRef = useRef(null);

      // ğŸ® ë°ëª¨ìš© ì´ˆê¸° ìƒíƒœ: ì‹ ê·œ ìœ ì € (ì•„ë¬´ê²ƒë„ ì•ˆ í•œ ìƒíƒœ)
      const [userData, setUserData] = useState({
        goldBalance: 0,
        usdcBalance: 0,
        currentXP: 0,
        claimedLevels: [],
        miningStatus: 'ready',
        cooldownTime: 10,
        totalNudgeXP: 0,
        hasReferral: false,
      });

      const [friends, setFriends] = useState(INITIAL_FRIENDS);
      const [nickname, setNickname] = useState(''); // ë‹‰ë„¤ì„ ìƒíƒœ

      const currentLevel = getCurrentLevel(userData.currentXP);

      // ì¿¨íƒ€ì„ ê³„ì‚° í•¨ìˆ˜ (PRD ê¸°ë°˜)
      const getNextCooldown = (count) => {
        if (count < COOLDOWN_SEQUENCE.length) {
          return COOLDOWN_SEQUENCE[count];
        }
        // 60ë¶„ ì´í›„ +5ë¶„ì”© ì¦ê°€
        const extraCycles = count - COOLDOWN_SEQUENCE.length;
        return MAX_COOLDOWN + (extraCycles + 1) * COOLDOWN_INCREMENT;
      };

      const showToast = (message) => {
        setToast(message);
      };

      // ğŸ® ë°ëª¨ìš©: Nudge ìˆ˜ì‹  íŒì—… ë¹„í™œì„±í™” (ê¹”ë”í•œ ì‹œì‘ì„ ìœ„í•´)
      // í•„ìš”ì‹œ ì¹œêµ¬ ì´ˆëŒ€ í™”ë©´ì—ì„œ ì§ì ‘ Nudgeë¥¼ ë³´ë‚´ë©´ ë¨
      useEffect(() => {
        // ìë™ Nudge íŒì—… ë¹„í™œì„±í™”ë¨
      }, [screen]);

      const handleMine = () => {
        const cooldownSeconds = getNextCooldown(miningCount);
        setUserData(prev => ({
          ...prev,
          miningStatus: 'mining',
          cooldownTime: cooldownSeconds
        }));

        // ë°ëª¨ìš©: ì¿¨íƒ€ì„ ë‹¨ì¶• (ì‹¤ì œ ì¿¨íƒ€ì„ì˜ 1/10)
        const demoCooldown = Math.min(cooldownSeconds, 10) * 1000;
        setTimeout(() => {
          setUserData(prev => ({
            ...prev,
            miningStatus: 'harvestable'
          }));
        }, demoCooldown);
      };

      const handleHarvest = () => {
        const reward = currentLevel >= 5 ? 0.5 : 0.1;
        const nextCooldown = getNextCooldown(miningCount + 1);
        setMiningCount(prev => prev + 1);
        setUserData(prev => ({
          ...prev,
          goldBalance: prev.goldBalance + reward,
          miningStatus: 'ready',
          cooldownTime: nextCooldown
        }));
        // ìˆ˜í™• ê²°ê³¼ ëª¨ë‹¬ í‘œì‹œ (PRD ê¸°ë°˜)
        setHarvestResult({
          reward,
          nextCooldown
        });
      };

      // ìˆ˜í™• ëª¨ë‹¬ ë‹«ê¸°
      const closeHarvestModal = () => {
        setHarvestResult(null);
      };

      // ë ˆë²¨ì—… CTA í´ë¦­ â†’ ì¹œêµ¬ ì´ˆëŒ€ í™”ë©´ìœ¼ë¡œ ì´ë™
      const handleLevelUpCTA = () => {
        setHarvestResult(null);
        setActiveTab('friends');
      };

      const handleNudge = (friendId) => {
        const friend = friends.find(f => f.id === friendId);
        setFriends(prev => prev.map(f =>
          f.id === friendId
            ? { ...f, lastNudge: new Date().toDateString() }
            : f
        ));
        setUserData(prev => ({
          ...prev,
          currentXP: prev.currentXP + 1,
          totalNudgeXP: prev.totalNudgeXP + 1
        }));
        // PRD ê¸°ë°˜ Nudge í† ìŠ¤íŠ¸ í˜•ì‹
        showToast(`ğŸ‘† ${friend.name}ë‹˜ì„ ì½• ì°”ë €ì–´ìš”! +1 XP`);

        // ì‹œë®¬ë ˆì´ì…˜: 3ì´ˆ í›„ Nudge ì„±ê³µ
        setTimeout(() => {
          setUserData(prev => ({
            ...prev,
            currentXP: prev.currentXP + 3,
            totalNudgeXP: prev.totalNudgeXP + 3
          }));
          // PRD ê¸°ë°˜ Nudge ì„±ê³µ í† ìŠ¤íŠ¸ í˜•ì‹
          showToast(`ğŸ‰ ${friend.name}ë‹˜ì´ ê¸ˆìºê¸°ë¥¼ ì‹œì‘í–ˆì–´ìš”! +3 XP`);
        }, 3000);
      };

      // ğŸ® ë°ëª¨ìš©: ì¹œêµ¬ ì´ˆëŒ€ ì‹œë®¬ë ˆì´ì…˜
      const handleInviteFriend = () => {
        // ìƒˆ ì¹œêµ¬ ì¶”ê°€
        const newFriendNames = ['ì •**', 'í•œ**', 'ì˜¤**', 'ì¥**', 'ì„œ**', 'ìœ¤**'];
        const existingIds = friends.map(f => f.id);
        const newId = Math.max(...existingIds, 0) + 1;
        const randomName = newFriendNames[newId % newFriendNames.length];

        const newFriend = {
          id: newId,
          name: randomName,
          status: 'cooldown_ready',
          lastNudge: null
        };

        setFriends(prev => [...prev, newFriend]);

        // PRD ê¸°ë°˜: ì¹œêµ¬ ì´ˆëŒ€ ì‹œ ì–‘ìª½ì— 1mg ì§€ê¸‰
        setUserData(prev => ({
          ...prev,
          goldBalance: prev.goldBalance + 1,
          currentXP: prev.currentXP + 5, // ì´ˆëŒ€ ë³´ë„ˆìŠ¤ XP
        }));

        showToast(`ğŸ‰ ${randomName}ë‹˜ì´ ê°€ì…í–ˆì–´ìš”! +1mg, +5 XP`);
      };

      const handleClaimReward = (level) => {
        const reward = BATTLEPASS_LEVELS[level - 1].reward;
        setUserData(prev => ({
          ...prev,
          goldBalance: prev.goldBalance + reward,
          claimedLevels: [...prev.claimedLevels, level]
        }));
        showToast(`ğŸª™ ${reward}mg íšë“!`);
      };

      const handleLogin = () => {
        // ë¡œê·¸ì¸ í›„ ë ˆí¼ëŸ´ í™”ë©´ìœ¼ë¡œ
        setScreen('referral');
      };

      const handleReferralComplete = (hasCode) => {
        const bonusGold = hasCode ? 11 : 10; // ë ˆí¼ëŸ´ ìˆìœ¼ë©´ +1mg
        setUserData(prev => ({
          ...prev,
          goldBalance: bonusGold,
          hasReferral: hasCode
        }));
        setScreen('nickname'); // ë‹‰ë„¤ì„ ì„¤ì • í™”ë©´ìœ¼ë¡œ
        showToast(`ğŸª™ ê¸ˆ ${bonusGold}mg ì§€ê¸‰ ì™„ë£Œ!`);
      };

      const handleNicknameComplete = (name) => {
        setNickname(name);
        setScreen('main');
        showToast(`ğŸ‘‹ ${name}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!`);
      };

      const handleLogout = () => {
        setScreen('intro');
        setActiveTab('home');
        setMiningCount(0);
        setNickname(''); // ë‹‰ë„¤ì„ ì´ˆê¸°í™”
        setIsPhoneVerified(false); // ì „í™”ë²ˆí˜¸ ì¸ì¦ ì´ˆê¸°í™”
        setUserData({
          goldBalance: 0,
          usdcBalance: 0,
          currentXP: 0,
          claimedLevels: [],
          miningStatus: 'ready',
          cooldownTime: 10,
          totalNudgeXP: 0,
          hasReferral: false,
        });
        setFriends(INITIAL_FRIENDS);
      };

      const handleNudgePopupClose = () => {
        setShowNudgePopup(false);
      };

      const handleNudgeStartMining = () => {
        setShowNudgePopup(false);
        handleMine();
      };

      const navigate = (tab) => {
        if (tab === 'tutorial') {
          setShowTutorial(true);
        } else if (tab === 'phone-input') {
          setPhoneVerificationStep('phone-input');
          setPhoneNumber('');
        } else if (tab === 'phone-otp') {
          setPhoneVerificationStep('phone-otp');
        } else if (tab === 'phone-success') {
          setPhoneVerificationStep('phone-success');
        } else if (tab === 'home') {
          setPhoneVerificationStep(null);
          setActiveTab('home');
        } else {
          setActiveTab(tab);
        }
      };

      const renderScreen = () => {
        // íŠœí† ë¦¬ì–¼ í™”ë©´ (ì„¤ì •ì—ì„œ ì§„ì…)
        if (showTutorial) {
          return <TutorialScreen onComplete={() => setShowTutorial(false)} />;
        }

        // íœ´ëŒ€í° ì¸ì¦ í™”ë©´
        if (phoneVerificationStep === 'phone-input') {
          return <PhoneVerificationScreen1 onNext={navigate} onNavigate={navigate} />;
        }
        if (phoneVerificationStep === 'phone-otp') {
          return <PhoneVerificationScreen2 phoneNumber={phoneNumber} onNext={navigate} onNavigate={navigate} />;
        }
        if (phoneVerificationStep === 'phone-success') {
          return <PhoneVerificationSuccess onComplete={() => {
            setIsPhoneVerified(true);
            setPhoneVerificationStep(null);
            navigate('friends');
          }} />;
        }

        if (screen !== 'main') {
          switch (screen) {
            case 'intro':
              return <IntroScreen onNext={() => setScreen('quiz')} />;
            case 'quiz':
              return <QuizScreen onComplete={() => setScreen('complete')} onSkip={() => setScreen('login')} containerRef={containerRef} />;
            case 'complete':
              return <CompleteScreen onNext={() => setScreen('login')} containerRef={containerRef} />;
            case 'login':
              return <LoginScreen onLogin={handleLogin} />;
            case 'referral':
              return <ReferralScreen onComplete={handleReferralComplete} onSkip={() => handleReferralComplete(false)} />;
            case 'nickname':
              return <NicknameScreen onComplete={handleNicknameComplete} />;
          }
        }

        switch (activeTab) {
          case 'home':
            return <HomeScreen userData={{...userData, currentLevel}} onMine={handleMine} onHarvest={handleHarvest} onNavigate={navigate} containerRef={containerRef} />;
          case 'friends':
            return <FriendsScreen userData={{...userData, currentLevel}} friends={friends} onNudge={handleNudge} onClaimReward={handleClaimReward} onNavigate={navigate} onInviteFriend={handleInviteFriend} containerRef={containerRef} isPhoneVerified={isPhoneVerified} />;
          case 'settings':
            return <SettingsScreen onNavigate={navigate} onLogout={handleLogout} isPhoneVerified={isPhoneVerified} nickname={nickname} onNicknameChange={setNickname} />;
          case 'receive':
            return <ReceiveScreen onNavigate={navigate} />;
          case 'send':
            return <SendScreen userData={userData} onNavigate={navigate} />;
          case 'dollarMining':
            return <DollarMiningScreen userData={userData} onNavigate={navigate} />;
          default:
            return <HomeScreen userData={{...userData, currentLevel}} onMine={handleMine} onHarvest={handleHarvest} onNavigate={navigate} containerRef={containerRef} />;
        }
      };

      const showNav = screen === 'main' && !['receive', 'send', 'dollarMining'].includes(activeTab) && !showTutorial;

      return (
        <div className="phone-frame" ref={containerRef}>
          {renderScreen()}
          {showNav && <BottomNav active={activeTab} onChange={setActiveTab} />}
          {toast && <Toast message={toast} onClose={() => setToast(null)} />}
          {harvestResult && screen === 'main' && (
            <HarvestResultModal
              reward={harvestResult.reward}
              currentLevel={currentLevel}
              nextCooldown={harvestResult.nextCooldown}
              onClose={closeHarvestModal}
              onLevelUp={handleLevelUpCTA}
            />
          )}
          {showNudgePopup && screen === 'main' && (
            <NudgeReceivedPopup
              senderName={nudgeSender}
              onClose={handleNudgePopupClose}
              onStartMining={handleNudgeStartMining}
            />
          )}
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
